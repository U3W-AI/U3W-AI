(global["webpackJsonp"] = global["webpackJsonp"] || []).push([["pages/work/index"],{

/***/ 66:
/*!*****************************************************************************!*\
  !*** D:/AAAi/U3W-AI-main/cube-mini/main.js?{"page":"pages%2Fwork%2Findex"} ***!
  \*****************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(wx, createPage) {

var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ 4);
__webpack_require__(/*! uni-pages */ 26);
__webpack_require__(/*! @dcloudio/uni-stat/dist/uni-stat.es.js */ 27);
var _vue = _interopRequireDefault(__webpack_require__(/*! vue */ 25));
var _index = _interopRequireDefault(__webpack_require__(/*! ./pages/work/index.vue */ 67));
// @ts-ignore
wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;
createPage(_index.default);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/wx.js */ 1)["default"], __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */ 2)["createPage"]))

/***/ }),

/***/ 67:
/*!**********************************************************!*\
  !*** D:/AAAi/U3W-AI-main/cube-mini/pages/work/index.vue ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _index_vue_vue_type_template_id_51b5538d_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index.vue?vue&type=template&id=51b5538d&scoped=true& */ 68);
/* harmony import */ var _index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index.vue?vue&type=script&lang=js& */ 70);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__) if(["default"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__[key]; }) }(__WEBPACK_IMPORT_KEY__));
/* harmony import */ var _index_vue_vue_type_style_index_0_id_51b5538d_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./index.vue?vue&type=style&index=0&id=51b5538d&scoped=true&lang=css& */ 84);
/* harmony import */ var _HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */ 52);

var renderjs





/* normalize component */

var component = Object(_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__["default"])(
  _index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__["default"],
  _index_vue_vue_type_template_id_51b5538d_scoped_true___WEBPACK_IMPORTED_MODULE_0__["render"],
  _index_vue_vue_type_template_id_51b5538d_scoped_true___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"],
  false,
  null,
  "51b5538d",
  null,
  false,
  _index_vue_vue_type_template_id_51b5538d_scoped_true___WEBPACK_IMPORTED_MODULE_0__["components"],
  renderjs
)

component.options.__file = "pages/work/index.vue"
/* harmony default export */ __webpack_exports__["default"] = (component.exports);

/***/ }),

/***/ 68:
/*!*****************************************************************************************************!*\
  !*** D:/AAAi/U3W-AI-main/cube-mini/pages/work/index.vue?vue&type=template&id=51b5538d&scoped=true& ***!
  \*****************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_17_0_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_template_id_51b5538d_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--17-0!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=51b5538d&scoped=true& */ 69);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "render", function() { return _HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_17_0_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_template_id_51b5538d_scoped_true___WEBPACK_IMPORTED_MODULE_0__["render"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return _HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_17_0_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_template_id_51b5538d_scoped_true___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "recyclableRender", function() { return _HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_17_0_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_template_id_51b5538d_scoped_true___WEBPACK_IMPORTED_MODULE_0__["recyclableRender"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "components", function() { return _HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_17_0_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_template_id_51b5538d_scoped_true___WEBPACK_IMPORTED_MODULE_0__["components"]; });



/***/ }),

/***/ 69:
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--17-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!D:/AAAi/U3W-AI-main/cube-mini/pages/work/index.vue?vue&type=template&id=51b5538d&scoped=true& ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return staticRenderFns; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "recyclableRender", function() { return recyclableRender; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "components", function() { return components; });
var components
var render = function () {
  var _vm = this
  var _h = _vm.$createElement
  var _c = _vm._self._c || _h
  var l2 = _vm.sectionExpanded.aiConfig
    ? _vm.__map(_vm.aiList, function (ai, index) {
        var $orig = _vm.__get_orig(ai)
        var m0 = ai.enabled && _vm.isAiLoginEnabled(ai)
        var m1 = _vm.isAiLoginEnabled(ai)
        var m2 = _vm.isAiLoginEnabled(ai)
        var m3 = !_vm.isAiLoginEnabled(ai) && !_vm.isAiInLoading(ai)
        var m4 = _vm.isAiInLoading(ai)
        var m5 = ai.enabled && _vm.isAiLoginEnabled(ai)
        var m6 = !_vm.isAiLoginEnabled(ai) || _vm.isAiInLoading(ai)
        var m7 =
          ai.name === "è…¾è®¯å…ƒå®" && ai.models ? _vm.getModelIndex(ai) : null
        var m8 =
          ai.name === "è…¾è®¯å…ƒå®" && ai.models
            ? !ai.enabled || !_vm.isAiLoginEnabled(ai)
            : null
        var m9 =
          ai.name === "è…¾è®¯å…ƒå®" && ai.models
            ? _vm.getSelectedModelLabel(ai)
            : null
        var g0 = ai.capabilities.length
        var l0 =
          g0 > 0 && (ai.name === "é€šä¹‰åƒé—®" || ai.name === "çŸ¥ä¹ç›´ç­”")
            ? _vm.__map(ai.capabilities, function (capability, capIndex) {
                var $orig = _vm.__get_orig(capability)
                var m10 = !ai.enabled || !_vm.isAiLoginEnabled(ai)
                return {
                  $orig: $orig,
                  m10: m10,
                }
              })
            : null
        var l1 =
          g0 > 0 && !(ai.name === "é€šä¹‰åƒé—®" || ai.name === "çŸ¥ä¹ç›´ç­”")
            ? _vm.__map(ai.capabilities, function (capability, capIndex) {
                var $orig = _vm.__get_orig(capability)
                var g1 = !ai.isSingleSelect
                  ? ai.selectedCapabilities.includes(capability.value)
                  : null
                var m11 = !ai.enabled || !_vm.isAiLoginEnabled(ai)
                return {
                  $orig: $orig,
                  g1: g1,
                  m11: m11,
                }
              })
            : null
        return {
          $orig: $orig,
          m0: m0,
          m1: m1,
          m2: m2,
          m3: m3,
          m4: m4,
          m5: m5,
          m6: m6,
          m7: m7,
          m8: m8,
          m9: m9,
          g0: g0,
          l0: l0,
          l1: l1,
        }
      })
    : null
  var g2 = _vm.sectionExpanded.promptInput ? _vm.promptInput.length : null
  var l4 =
    _vm.taskStarted && _vm.sectionExpanded.taskStatus
      ? _vm.__map(_vm.enabledAIs, function (ai, index) {
          var $orig = _vm.__get_orig(ai)
          var m12 = _vm.getStatusText(ai.status)
          var m13 = _vm.getStatusIconClass(ai.status)
          var m14 = _vm.getStatusEmoji(ai.status)
          var g3 = ai.isExpanded && ai.progressLogs.length > 0
          var l3 = g3
            ? _vm.__map(ai.progressLogs, function (log, logIndex) {
                var $orig = _vm.__get_orig(log)
                var m15 = _vm.formatTime(log.timestamp)
                return {
                  $orig: $orig,
                  m15: m15,
                }
              })
            : null
          return {
            $orig: $orig,
            m12: m12,
            m13: m13,
            m14: m14,
            g3: g3,
            l3: l3,
          }
        })
      : null
  var g4 = _vm.results.length
  var g5 =
    g4 > 0 && _vm.currentResult
      ? _vm.currentResult.aiName.includes("æ™ºèƒ½æ’ç‰ˆ")
      : null
  var m16 =
    g4 > 0 && _vm.currentResult && !!g5
      ? _vm.getMediaLabelFromResult(_vm.currentResult)
      : null
  var m17 =
    g4 > 0 && _vm.currentResult
      ? _vm.currentResult.shareImgUrl &&
        _vm.isImageFile(_vm.currentResult.shareImgUrl)
      : null
  var m18 =
    g4 > 0 && _vm.currentResult && !m17
      ? _vm.currentResult.shareImgUrl &&
        _vm.isPdfFile(_vm.currentResult.shareImgUrl)
      : null
  var m19 =
    g4 > 0 &&
    _vm.currentResult &&
    !m17 &&
    !m18 &&
    !(_vm.currentResult.aiName === "DeepSeek")
      ? _vm.renderMarkdown(_vm.currentResult.content)
      : null
  var l6 = _vm.historyDrawerVisible
    ? _vm.__map(_vm.groupedHistory, function (group, date) {
        var $orig = _vm.__get_orig(group)
        var l5 = _vm.__map(group, function (item, index) {
          var $orig = _vm.__get_orig(item)
          var m20 = _vm.formatHistoryTime(item.createTime)
          return {
            $orig: $orig,
            m20: m20,
          }
        })
        return {
          $orig: $orig,
          l5: l5,
        }
      })
    : null
  var g6 = _vm.scoreModalVisible ? _vm.scorePromptList.length : null
  var m21 = _vm.scoreModalVisible && g6 > 0 ? _vm.getScorePromptIndex() : null
  var l7 = _vm.scoreModalVisible
    ? _vm.__map(_vm.results, function (result, index) {
        var $orig = _vm.__get_orig(result)
        var g7 = _vm.selectedResults.includes(result.aiName)
        return {
          $orig: $orig,
          g7: g7,
        }
      })
    : null
  var l8 = _vm.tthFlowVisible
    ? _vm.__map(_vm.tthFlowLogs, function (log, index) {
        var $orig = _vm.__get_orig(log)
        var m22 = _vm.formatTime(log.timestamp)
        return {
          $orig: $orig,
          m22: m22,
        }
      })
    : null
  var g8 = _vm.tthFlowVisible ? _vm.tthFlowLogs.length : null
  var g9 = _vm.tthFlowVisible ? _vm.tthFlowImages.length : null
  _vm.$mp.data = Object.assign(
    {},
    {
      $root: {
        l2: l2,
        g2: g2,
        l4: l4,
        g4: g4,
        g5: g5,
        m16: m16,
        m17: m17,
        m18: m18,
        m19: m19,
        l6: l6,
        g6: g6,
        m21: m21,
        l7: l7,
        l8: l8,
        g8: g8,
        g9: g9,
      },
    }
  )
}
var recyclableRender = false
var staticRenderFns = []
render._withStripped = true



/***/ }),

/***/ 70:
/*!***********************************************************************************!*\
  !*** D:/AAAi/U3W-AI-main/cube-mini/pages/work/index.vue?vue&type=script&lang=js& ***!
  \***********************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--13-1!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js& */ 71);
/* harmony import */ var _HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__) if(["default"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ 71:
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--13-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!D:/AAAi/U3W-AI-main/cube-mini/pages/work/index.vue?vue&type=script&lang=js& ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(wx, uni) {

var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ 4);
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ 72));
var _slicedToArray2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ 5));
var _typeof2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/typeof */ 13));
var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ 74));
var _defineProperty2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/defineProperty */ 11));
var _marked = __webpack_require__(/*! marked */ 75);
var _aigc = __webpack_require__(/*! @/api/wechat/aigc */ 77);
var _uuid = __webpack_require__(/*! uuid */ 78);
var _storage = _interopRequireDefault(__webpack_require__(/*! @/utils/storage */ 40));
var _constant = _interopRequireDefault(__webpack_require__(/*! @/utils/constant */ 41));
var _auth = __webpack_require__(/*! @/utils/auth */ 45);
var _corpId = __webpack_require__(/*! @/utils/corpId */ 83);
function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }
function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }
var _default = {
  name: 'MiniConsole',
  data: function data() {
    return {
      // ç³»ç»Ÿä¿¡æ¯
      statusBarHeight: 0,
      // ç”¨æˆ·ä¿¡æ¯
      userId: '',
      corpId: '',
      chatId: '',
      expandedHistoryItems: {},
      userInfoReq: {
        userPrompt: '',
        userId: '',
        corpId: '',
        taskId: '',
        roles: '',
        toneChatId: '',
        ybDsChatId: '',
        dbChatId: '',
        tyChatId: '',
        baiduChatId: '',
        zhzdChatId: '',
        isNewChat: true
      },
      jsonRpcReqest: {
        jsonrpc: '2.0',
        id: '',
        method: '',
        params: {}
      },
      // åŒºåŸŸå±•å¼€çŠ¶æ€
      sectionExpanded: {
        aiConfig: true,
        promptInput: true,
        taskStatus: true
      },
      // AIé…ç½®ï¼ˆå‚è€ƒPCç«¯å®Œæ•´é…ç½®ï¼‰
      aiList: [{
        name: 'DeepSeek',
        avatar: 'https://u3w.com/chatfile/Deepseek.png',
        capabilities: [{
          label: 'æ·±åº¦æ€è€ƒ',
          value: 'deep_thinking'
        }, {
          label: 'è”ç½‘æœç´¢',
          value: 'web_search'
        }],
        selectedCapabilities: ['deep_thinking', 'web_search'],
        enabled: true,
        status: 'idle',
        progressLogs: [],
        isExpanded: true,
        isSingleSelect: false // æ·»åŠ å•é€‰æ ‡è®°
      }, {
        name: 'è±†åŒ…',
        avatar: 'https://u3w.com/chatfile/%E8%B1%86%E5%8C%85.png',
        capabilities: [{
          label: 'æ·±åº¦æ€è€ƒ',
          value: 'deep_thinking'
        }],
        selectedCapabilities: ['deep_thinking'],
        enabled: true,
        status: 'idle',
        progressLogs: [],
        isExpanded: true,
        isSingleSelect: false // æ·»åŠ å•é€‰æ ‡è®°
      }, {
        name: 'è…¾è®¯å…ƒå®',
        avatar: 'https://u3w.com/chatfile/yuanbao.png',
        capabilities: [{
          label: 'æ·±åº¦æ€è€ƒ',
          value: 'deep_thinking'
        }, {
          label: 'è”ç½‘æœç´¢',
          value: 'web_search'
        }],
        selectedCapabilities: ['deep_thinking', 'web_search'],
        selectedModel: 'hunyuan',
        // é»˜è®¤é€‰æ‹©æ··å…ƒ
        models: [{
          label: 'æ··å…ƒ',
          value: 'hunyuan'
        }, {
          label: 'DeepSeek',
          value: 'deepseek'
        }],
        enabled: true,
        status: 'idle',
        progressLogs: [],
        isExpanded: true,
        isSingleSelect: false
      }, {
        name: 'é€šä¹‰åƒé—®',
        avatar: 'https://u3w.com/chatfile/TongYi.png',
        capabilities: [{
          label: 'æ·±åº¦æ€è€ƒ',
          value: 'deep_thinking'
        }, {
          label: 'è”ç½‘æœç´¢',
          value: 'web_search'
        }],
        selectedCapability: '',
        enabled: true,
        status: 'idle',
        progressLogs: [],
        isExpanded: true
      }, {
        name: "ç§˜å¡”",
        avatar: 'https://www.aitool6.com/wp-content/uploads/2023/06/9557d1-2.jpg',
        capabilities: [{
          label: "æé€Ÿ",
          value: "fast"
        }, {
          label: "æé€Ÿæ€è€ƒ",
          value: "fast_thinking"
        }, {
          label: "é•¿æ€è€ƒ",
          value: "long_thinking"
        }],
        selectedCapabilities: "fast",
        enabled: true,
        status: "idle",
        progressLogs: [],
        isExpanded: true,
        isSingleSelect: true // æ·»åŠ å•é€‰æ ‡è®°
      }, {
        name: "çŸ¥ä¹ç›´ç­”",
        avatar: 'https://u3w.com/chatfile/ZHZD.png',
        capabilities: [{
          label: "æ™ºèƒ½æ€è€ƒ",
          value: "smart_thinking"
        }, {
          label: "æ·±åº¦æ€è€ƒ",
          value: "deep_thinking"
        }, {
          label: "å¿«é€Ÿå›ç­”",
          value: "fast_answer"
        }],
        selectedCapability: "smart_thinking",
        // æ”¹ä¸ºå•é€‰ï¼Œé»˜è®¤æ™ºèƒ½æ€è€ƒ
        enabled: true,
        status: 'idle',
        progressLogs: [],
        isExpanded: true,
        isSingleSelect: true // è®¾ä¸ºå•é€‰æ¨¡å¼
      }, {
        name: "ç™¾åº¦AI",
        avatar: 'https://u3w.com/chatfile/baiduAI.png',
        capabilities: [{
          label: "æ·±åº¦æœç´¢",
          value: "web_search"
        }],
        selectedCapabilities: [],
        enabled: true,
        status: "idle",
        progressLogs: [],
        isExpanded: true
      }],
      // è¾“å…¥å’Œä»»åŠ¡çŠ¶æ€
      promptInput: '',
      taskStarted: false,
      enabledAIs: [],
      // å¯è§†åŒ–
      screenshots: [],
      autoPlay: false,
      // ç»“æœ
      results: [],
      activeResultIndex: 0,
      // å†å²è®°å½•
      chatHistory: [],
      // è¯„åˆ†
      selectedResults: [],
      scorePrompt: 'è¯·ä½ æ·±åº¦é˜…è¯»ä»¥ä¸‹å‡ ç¯‡å…¬ä¼—å·æ–‡ç« ï¼Œä»å¤šä¸ªç»´åº¦è¿›è¡Œé€é¡¹æ‰“åˆ†ï¼Œè¾“å‡ºè¯„åˆ†ç»“æœã€‚å¹¶åœ¨ä»¥ä¸‹å„ç¯‡æ–‡ç« çš„åŸºç¡€ä¸Šåšé‡‡ä¼—é•¿ï¼Œç»¼åˆæ•´ç†ä¸€ç¯‡æ›´å…¨é¢çš„æ–‡ç« ã€‚',
      scoreAI: 'è±†åŒ…',
      // é»˜è®¤é€‰æ‹©è±†åŒ…ä½œä¸ºè¯„åˆ†AI
      scorePromptList: [],
      // è¯„åˆ†æç¤ºè¯æ¨¡æ¿åˆ—è¡¨
      selectedScorePrompt: '',
      // é€‰ä¸­çš„è¯„åˆ†æç¤ºè¯æ¨¡æ¿åç§°

      // æ”¶å½•è®¡æ•°å™¨
      collectNum: 0,
      // åª’ä½“æŠ•é€’
      layoutPrompt: '',
      layoutAI: 'è±†åŒ…',
      // é»˜è®¤é€‰æ‹©è±†åŒ…ä½œä¸ºæ’ç‰ˆAI
      selectedMedia: 'wechat_layout',
      // é»˜è®¤é€‰æ‹©å…¬ä¼—å·

      // å¾®å¤´æ¡ç›¸å…³
      tthArticleEditVisible: false,
      // å¾®å¤´æ¡æ–‡ç« ç¼–è¾‘å¼¹çª—
      tthArticleTitle: '',
      // å¾®å¤´æ¡æ–‡ç« æ ‡é¢˜
      tthArticleContent: '',
      // å¾®å¤´æ¡æ–‡ç« å†…å®¹
      tthFlowVisible: false,
      // å¾®å¤´æ¡å‘å¸ƒæµç¨‹å¼¹çª—
      tthFlowLogs: [],
      // å¾®å¤´æ¡å‘å¸ƒæµç¨‹æ—¥å¿—
      tthFlowImages: [],
      // å¾®å¤´æ¡å‘å¸ƒæµç¨‹å›¾ç‰‡
      tthScoreContent: '',
      // æ™ºèƒ½è¯„åˆ†å†…å®¹

      // åª’ä½“åˆ—è¡¨é…ç½®
      mediaList: [{
        name: "wechat_layout",
        label: "å…¬ä¼—å·"
      }, {
        name: "zhihu_layout",
        label: "çŸ¥ä¹"
      }, {
        name: "weitoutiao_layout",
        label: "å¾®å¤´æ¡"
      }, {
        name: "baijiahao_layout",
        label: "ç™¾å®¶å·"
      }],
      // WebSocket
      socketTask: null,
      reconnectTimer: null,
      heartbeatTimer: null,
      reconnectCount: 0,
      maxReconnectCount: 5,
      isConnecting: false,
      isRefreshing: false,
      // é˜²é‡å¤åˆ·æ–°æ ‡å¿—
      scrollIntoView: '',
      // å¼¹çª—çŠ¶æ€
      historyDrawerVisible: false,
      scoreModalVisible: false,
      layoutModalVisible: false,
      currentLayoutResult: null,
      // å½“å‰è¦æ’ç‰ˆçš„ç»“æœ

      // AIç™»å½•çŠ¶æ€
      aiLoginStatus: {
        yuanbao: false,
        doubao: false,
        deepseek: false,
        tongyi: false,
        metaso: false,
        zhzd: false,
        baidu: false
      },
      accounts: {
        yuanbao: '',
        doubao: '',
        deepseek: '',
        tongyi: '',
        metaso: '',
        zhzd: '',
        baidu: ''
      },
      isLoading: {
        yuanbao: true,
        doubao: true,
        deepseek: true,
        tongyi: true,
        metaso: true,
        zhzd: true,
        baidu: true
      }
    };
  },
  computed: {
    canSend: function canSend() {
      var _this = this;
      // æ£€æŸ¥æ˜¯å¦æœ‰è¾“å…¥å†…å®¹
      var hasInput = this.promptInput.trim().length > 0;

      // æ£€æŸ¥æ˜¯å¦æœ‰å¯ç”¨çš„AIï¼ˆæ—¢å¯ç”¨åˆå·²ç™»å½•ï¼‰
      var hasAvailableAI = this.aiList.some(function (ai) {
        return ai.enabled && _this.isAiLoginEnabled(ai);
      });

      // æ£€æŸ¥æ˜¯å¦æ­£åœ¨åŠ è½½AIçŠ¶æ€ï¼ˆå¦‚æœæ­£åœ¨åŠ è½½ï¼Œç¦ç”¨å‘é€æŒ‰é’®ï¼‰
      var isCheckingStatus = this.isLoading.yuanbao || this.isLoading.doubao || this.isLoading.deepseek || this.isLoading.tongyi || this.isLoading.metaso || this.isLoading.zhzd || this.isLoading.baidu;
      return hasInput && hasAvailableAI && !isCheckingStatus;
    },
    canScore: function canScore() {
      var hasSelected = this.selectedResults.length > 0;
      var hasPrompt = this.scorePrompt.trim().length > 0;
      console.log('canScore - selectedResults:', this.selectedResults);
      console.log('canScore - scorePrompt length:', this.scorePrompt.trim().length);
      console.log('canScore - hasSelected:', hasSelected, 'hasPrompt:', hasPrompt);
      return hasSelected && hasPrompt;
    },
    currentResult: function currentResult() {
      return this.results[this.activeResultIndex] || null;
    },
    groupedHistory: function groupedHistory() {
      var _this2 = this;
      var groups = {};
      var chatGroups = {};

      // é¦–å…ˆæŒ‰chatIdåˆ†ç»„
      this.chatHistory.forEach(function (item) {
        if (!chatGroups[item.chatId]) {
          chatGroups[item.chatId] = [];
        }
        chatGroups[item.chatId].push(item);
      });

      // ç„¶åæŒ‰æ—¥æœŸåˆ†ç»„ï¼Œå¹¶å¤„ç†çˆ¶å­å…³ç³»
      Object.values(chatGroups).forEach(function (chatGroup) {
        // æŒ‰æ—¶é—´æ’åº
        chatGroup.sort(function (a, b) {
          return new Date(a.createTime) - new Date(b.createTime);
        });

        // è·å–æœ€æ—©çš„è®°å½•ä½œä¸ºçˆ¶çº§
        var parentItem = chatGroup[0];
        var date = _this2.getHistoryDate(parentItem.createTime);
        if (!groups[date]) {
          groups[date] = [];
        }

        // æ·»åŠ çˆ¶çº§è®°å½•
        groups[date].push(_objectSpread(_objectSpread({}, parentItem), {}, {
          isParent: true,
          isExpanded: _this2.expandedHistoryItems[parentItem.chatId] || false,
          children: chatGroup.slice(1).map(function (child) {
            return _objectSpread(_objectSpread({}, child), {}, {
              isParent: false
            });
          })
        }));
      });
      return groups;
    },
    // å¾®å¤´æ¡æ–‡ç« å†…å®¹å­—ç¬¦æ•°
    tthArticleContentLength: function tthArticleContentLength() {
      return this.tthArticleContent ? this.tthArticleContent.length : 0;
    },
    // æ£€æŸ¥å¾®å¤´æ¡æ–‡ç« å†…å®¹æ˜¯å¦è¶…è¿‡2000å­—
    isTthArticleContentExceeded: function isTthArticleContentExceeded() {
      return this.tthArticleContentLength > 2000;
    }
  },
  watch: {
    // ç›‘å¬å¾®å¤´æ¡æ–‡ç« å†…å®¹å˜åŒ–ï¼Œç¡®ä¿textareaæ­£ç¡®æ˜¾ç¤º
    tthArticleContent: {
      handler: function handler(newVal, oldVal) {
        var _this3 = this;
        // å½“å†…å®¹å˜åŒ–æ—¶ï¼Œç¡®ä¿textareaæ­£ç¡®æ˜¾ç¤º
        this.$nextTick(function () {
          var textarea = _this3.$el.querySelector('.score-textarea');
          if (textarea && textarea.value !== newVal) {
            textarea.value = newVal;
          }
        });
      },
      immediate: false
    }
  },
  onLoad: function onLoad() {
    var _this4 = this;
    return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee() {
      var windowInfo;
      return _regenerator.default.wrap(function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              // è·å–çŠ¶æ€æ é«˜åº¦ï¼ˆå°ç¨‹åºç¯å¢ƒï¼‰
              windowInfo = wx.getWindowInfo();
              _this4.statusBarHeight = windowInfo.statusBarHeight || 0;
              _context.next = 4;
              return _this4.initUserInfo();
            case 4:
              // ç›‘å¬ä¼ä¸šIDæ›´æ–°äº‹ä»¶
              uni.$on('corpIdUpdated', _this4.handleCorpIdUpdated);

              // æ£€æŸ¥ç”¨æˆ·ä¿¡æ¯æ˜¯å¦å®Œæ•´
              if (!(!_this4.userId || !_this4.corpId)) {
                _context.next = 9;
                break;
              }
              console.log('ç”¨æˆ·ä¿¡æ¯ä¸å®Œæ•´ï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢');
              uni.showModal({
                title: 'æç¤º',
                content: 'è¯·å…ˆç™»å½•åå†ä½¿ç”¨',
                showCancel: false,
                confirmText: 'å»ç™»å½•',
                success: function success() {
                  uni.navigateTo({
                    url: '/pages/login/index'
                  });
                }
              });
              return _context.abrupt("return");
            case 9:
              _this4.initWebSocket();
              _this4.loadChatHistory(0); // åŠ è½½å†å²è®°å½•
              _this4.loadLastChat(); // åŠ è½½ä¸Šæ¬¡ä¼šè¯
              _this4.initEnabledAIs(); // åˆå§‹åŒ–AIåˆ—è¡¨
              _this4.checkAiLoginStatus(); // æ£€æŸ¥AIç™»å½•çŠ¶æ€
            case 14:
            case "end":
              return _context.stop();
          }
        }
      }, _callee);
    }))();
  },
  onShow: function onShow() {
    // é¡µé¢æ˜¾ç¤ºæ—¶ç¡®ä¿ä¼ä¸šIDæœ€æ–°
    this.ensureLatestCorpId();
  },
  onUnload: function onUnload() {
    // ç§»é™¤äº‹ä»¶ç›‘å¬
    uni.$off('corpIdUpdated', this.handleCorpIdUpdated);
    this.closeWebSocket();
  },
  methods: {
    // ä»resultçš„aiNameä¸­æå–åª’ä½“æ ‡ç­¾
    getMediaLabelFromResult: function getMediaLabelFromResult(result) {
      if (!result || !result.aiName) return 'å…¬ä¼—å·';
      // ä» "æ™ºèƒ½æ’ç‰ˆå…¬ä¼—å·" æˆ– "æ™ºèƒ½æ’ç‰ˆçŸ¥ä¹" ä¸­æå–åª’ä½“åç§°
      var mediaLabel = result.aiName.substring(4); // å»æ‰"æ™ºèƒ½æ’ç‰ˆ"
      return mediaLabel || 'å…¬ä¼—å·';
    },
    // å¤„ç†textareaè·å¾—ç„¦ç‚¹äº‹ä»¶
    handleTextareaFocus: function handleTextareaFocus() {
      var _this5 = this;
      // ç¡®ä¿textareaå†…å®¹æ­£ç¡®æ˜¾ç¤º
      this.$nextTick(function () {
        var textarea = _this5.$el.querySelector('.score-textarea');
        if (textarea && textarea.value !== _this5.tthArticleContent) {
          textarea.value = _this5.tthArticleContent;
          // è§¦å‘inputäº‹ä»¶ç¡®ä¿v-modelåŒæ­¥
          textarea.dispatchEvent(new Event('input', {
            bubbles: true
          }));
        }
      });
    },
    // åˆå§‹åŒ–ç”¨æˆ·ä¿¡æ¯
    initUserInfo: function initUserInfo() {
      var _this6 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2() {
        return _regenerator.default.wrap(function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                // ä»storeè·å–ç”¨æˆ·ä¿¡æ¯ï¼Œå…¼å®¹ç¼“å­˜æ–¹å¼
                _this6.userId = _storage.default.get(_constant.default.userId);
                // ä½¿ç”¨ä¼ä¸šIDå·¥å…·è·å–æœ€æ–°ä¼ä¸šID
                _context2.prev = 1;
                _context2.next = 4;
                return (0, _corpId.getCorpId)();
              case 4:
                _this6.corpId = _context2.sent;
                _context2.next = 11;
                break;
              case 7:
                _context2.prev = 7;
                _context2.t0 = _context2["catch"](1);
                console.warn('è·å–ä¼ä¸šIDå¤±è´¥ï¼Œä½¿ç”¨ç¼“å­˜å€¼:', _context2.t0);
                _this6.corpId = _storage.default.get(_constant.default.corpId);
              case 11:
                _this6.chatId = _this6.generateUUID();

                // åˆå§‹åŒ–è¯·æ±‚å‚æ•°
                _this6.userInfoReq.userId = _this6.userId;
                _this6.userInfoReq.corpId = _this6.corpId;
                console.log('åˆå§‹åŒ–ç”¨æˆ·ä¿¡æ¯:', {
                  userId: _this6.userId,
                  corpId: _this6.corpId
                });
              case 15:
              case "end":
                return _context2.stop();
            }
          }
        }, _callee2, null, [[1, 7]]);
      }))();
    },
    // åˆå§‹åŒ–å¯ç”¨çš„AIåˆ—è¡¨
    initEnabledAIs: function initEnabledAIs() {
      // åˆå§‹åŒ–æ—¶æ˜¾ç¤ºæ‰€æœ‰AIï¼Œä¸è¿‡æ»¤ç™»å½•çŠ¶æ€
      this.enabledAIs = this.aiList.filter(function (ai) {
        return ai.enabled;
      });
      console.log('åˆå§‹åŒ–AIåˆ—è¡¨:', this.enabledAIs.map(function (ai) {
        return ai.name;
      }));
    },
    // ç¡®ä¿ä¼ä¸šIDæœ€æ–°
    ensureLatestCorpId: function ensureLatestCorpId() {
      var _this7 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee3() {
        var result;
        return _regenerator.default.wrap(function _callee3$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                _context3.prev = 0;
                _context3.next = 3;
                return (0, _corpId.ensureCorpIdOnShow)();
              case 3:
                result = _context3.sent;
                if (result.corpId !== _this7.corpId) {
                  console.log('ä¼ä¸šIDå·²æ›´æ–°:', result.corpId);
                  _this7.corpId = result.corpId;
                  _this7.userInfoReq.corpId = _this7.corpId;
                }
                _context3.next = 10;
                break;
              case 7:
                _context3.prev = 7;
                _context3.t0 = _context3["catch"](0);
                console.error('ç¡®ä¿ä¼ä¸šIDæœ€æ–°å¤±è´¥:', _context3.t0);
              case 10:
              case "end":
                return _context3.stop();
            }
          }
        }, _callee3, null, [[0, 7]]);
      }))();
    },
    // å¤„ç†ä¼ä¸šIDæ›´æ–°äº‹ä»¶
    handleCorpIdUpdated: function handleCorpIdUpdated(data) {
      var newCorpId = data.corpId;
      if (newCorpId && newCorpId !== this.corpId) {
        console.log('å°ç¨‹åºæ¥æ”¶åˆ°ä¼ä¸šIDæ›´æ–°äº‹ä»¶ï¼Œæ›´æ–°æœ¬åœ°corpId:', newCorpId);
        this.corpId = newCorpId;
        this.userInfoReq.corpId = newCorpId;
        uni.showToast({
          title: "\u4E3B\u673AID\u5DF2\u81EA\u52A8\u66F4\u65B0: ".concat(newCorpId),
          icon: 'success'
        });
      }
    },
    // ç”ŸæˆUUID
    generateUUID: function generateUUID() {
      return (0, _uuid.v4)();
    },
    // åˆ‡æ¢åŒºåŸŸå±•å¼€çŠ¶æ€
    toggleSection: function toggleSection(section) {
      this.sectionExpanded[section] = !this.sectionExpanded[section];
    },
    // åˆ‡æ¢AIå¯ç”¨çŠ¶æ€
    toggleAI: function toggleAI(ai, event) {
      // æ£€æŸ¥AIæ˜¯å¦å·²ç™»å½•
      if (!this.isAiLoginEnabled(ai)) {
        uni.showModal({
          title: 'æç¤º',
          content: "".concat(ai.name, "\u9700\u8981\u5148\u767B\u5F55\uFF0C\u8BF7\u524D\u5F80PC\u7AEF\u8FDB\u884C\u767B\u5F55\u540E\u518D\u4F7F\u7528"),
          showCancel: false,
          confirmText: 'çŸ¥é“äº†'
        });
        return;
      }
      ai.enabled = event.detail.value;
    },
    // è…¾è®¯å…ƒå®æ¨¡å‹é€‰æ‹©ç›¸å…³æ–¹æ³•
    getModelIndex: function getModelIndex(ai) {
      if (!ai.models || !ai.selectedModel) return 0;
      return ai.models.findIndex(function (model) {
        return model.value === ai.selectedModel;
      });
    },
    getSelectedModelLabel: function getSelectedModelLabel(ai) {
      if (!ai.models || !ai.selectedModel) return 'è¯·é€‰æ‹©æ¨¡å‹';
      var model = ai.models.find(function (model) {
        return model.value === ai.selectedModel;
      });
      return model ? model.label : 'è¯·é€‰æ‹©æ¨¡å‹';
    },
    onModelChange: function onModelChange(ai, event) {
      if (!ai.enabled || !this.isAiLoginEnabled(ai)) return;
      var index = event.detail.value;
      if (ai.models && ai.models[index]) {
        ai.selectedModel = ai.models[index].value;
        uni.showToast({
          title: "\u5DF2\u5207\u6362\u5230".concat(ai.models[index].label),
          icon: 'success',
          duration: 1500
        });
      }
    },
    // åˆ‡æ¢AIèƒ½åŠ›
    toggleCapability: function toggleCapability(ai, capabilityValue) {
      // æ£€æŸ¥AIæ˜¯å¦å·²ç™»å½•å’Œå¯ç”¨
      if (!this.isAiLoginEnabled(ai)) {
        uni.showModal({
          title: 'æç¤º',
          content: "".concat(ai.name, "\u9700\u8981\u5148\u767B\u5F55\uFF0C\u8BF7\u524D\u5F80PC\u7AEF\u8FDB\u884C\u767B\u5F55\u540E\u518D\u4F7F\u7528"),
          showCancel: false,
          confirmText: 'çŸ¥é“äº†'
        });
        return;
      }
      if (!ai.enabled) return;

      // å•é€‰é€»è¾‘ï¼ˆé’ˆå¯¹ç§˜å¡”AIï¼‰
      if (ai.isSingleSelect) {
        // ç›´æ¥è®¾ç½®ä¸ºå½“å‰é€‰ä¸­å€¼ï¼Œå®ç°å•é€‰æ•ˆæœ
        ai.selectedCapabilities = capabilityValue;
      }
      // å…¶ä»–AIä¿æŒå¤šé€‰é€»è¾‘
      else {
        var index = ai.selectedCapabilities.indexOf(capabilityValue);
        if (index === -1) {
          ai.selectedCapabilities.push(capabilityValue);
        } else {
          ai.selectedCapabilities.splice(index, 1);
        }
      }
    },
    // é€šä¹‰åƒé—®åˆ‡æ¢èƒ½åŠ›
    selectSingleCapability: function selectSingleCapability(ai, capabilityValue) {
      if (!ai.enabled || !this.isAiLoginEnabled(ai)) return;
      if (ai.selectedCapability === capabilityValue) {
        ai.selectedCapability = '';
      } else {
        ai.selectedCapability = capabilityValue;
      }
    },
    // å‘é€æç¤ºè¯
    sendPrompt: function sendPrompt() {
      var _this8 = this;
      console.log('ğŸš€ [sendPrompt] ========== å¼€å§‹å‘é€ä»»åŠ¡ ==========');
      console.log('ğŸš€ [sendPrompt] canSendçŠ¶æ€:', this.canSend);
      if (!this.canSend) {
        console.warn('âš ï¸ [sendPrompt] canSendä¸ºfalseï¼Œåœæ­¢å‘é€');
        return;
      }
      console.log('ğŸ“ [sendPrompt] ç”¨æˆ·è¾“å…¥æç¤ºè¯:', this.promptInput);
      console.log('ğŸ‘¤ [sendPrompt] ç”¨æˆ·ID:', this.userId);
      console.log('ğŸ¢ [sendPrompt] ä¼ä¸šID:', this.corpId);
      this.screenshots = [];
      // æŠ˜å æ‰€æœ‰åŒºåŸŸ
      this.sectionExpanded.aiConfig = false;
      this.sectionExpanded.promptInput = false;
      // this.sectionExpanded.taskStatus = false;

      this.taskStarted = true;
      this.results = []; // æ¸…ç©ºä¹‹å‰çš„ç»“æœ
      console.log('ğŸ—‘ï¸ [sendPrompt] æ¸…ç©ºä¹‹å‰çš„ç»“æœå’Œæˆªå›¾');
      this.userInfoReq.roles = '';
      this.userInfoReq.taskId = this.generateUUID();
      this.userInfoReq.userId = this.userId;
      this.userInfoReq.corpId = this.corpId;
      this.userInfoReq.userPrompt = this.promptInput;
      console.log('ğŸ« [sendPrompt] ç”Ÿæˆä»»åŠ¡ID:', this.userInfoReq.taskId);

      // è·å–å¯ç”¨çš„AIåˆ—è¡¨åŠå…¶çŠ¶æ€
      this.enabledAIs = this.aiList.filter(function (ai) {
        return ai.enabled && _this8.isAiLoginEnabled(ai);
      });
      console.log('ğŸ¤– [sendPrompt] ç­›é€‰å¯ç”¨çš„AIæ•°é‡:', this.enabledAIs.length);
      console.log('ğŸ¤– [sendPrompt] å¯ç”¨çš„AIåˆ—è¡¨:', this.enabledAIs.map(function (ai) {
        return ai.name;
      }).join(', '));

      // å°†æ‰€æœ‰å¯ç”¨çš„AIçŠ¶æ€è®¾ç½®ä¸ºè¿è¡Œä¸­
      this.enabledAIs.forEach(function (ai) {
        ai.status = 'running';
        console.log("\u25B6\uFE0F [sendPrompt] \u8BBE\u7F6E".concat(ai.name, "\u72B6\u6001\u4E3A: running"));
      });

      // æ„å»ºè§’è‰²å‚æ•°
      this.enabledAIs.forEach(function (ai) {
        if (ai.name === 'è…¾è®¯å…ƒå®') {
          if (ai.selectedModel === 'hunyuan') {
            // æ··å…ƒæ¨¡å‹
            _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'yb-hunyuan-pt,';
            if (ai.selectedCapabilities.includes("deep_thinking")) {
              _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'yb-hunyuan-sdsk,';
            }
            if (ai.selectedCapabilities.includes("web_search")) {
              _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'yb-hunyuan-lwss,';
            }
          } else if (ai.selectedModel === 'deepseek') {
            // DeepSeekæ¨¡å‹
            _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'yb-deepseek-pt,';
            if (ai.selectedCapabilities.includes("deep_thinking")) {
              _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'yb-deepseek-sdsk,';
            }
            if (ai.selectedCapabilities.includes("web_search")) {
              _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'yb-deepseek-lwss,';
            }
          }
        }
        if (ai.name === 'DeepSeek') {
          _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'deepseek,';
          if (ai.selectedCapabilities.includes("deep_thinking")) {
            _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'ds-sdsk,';
          }
          if (ai.selectedCapabilities.includes("web_search")) {
            _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'ds-lwss,';
          }
        }
        if (ai.name === 'è±†åŒ…') {
          _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'zj-db,';
          if (ai.selectedCapabilities.includes("deep_thinking")) {
            _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'zj-db-sdsk,';
          }
        }
        if (ai.name === 'ç§˜å¡”') {
          _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'mita,';
          if (ai.selectedCapabilities.includes("fast")) {
            _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'metaso-jisu,';
          }
          if (ai.selectedCapabilities.includes("fast_thinking")) {
            _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'metaso-jssk,';
          }
          if (ai.selectedCapabilities.includes("long_thinking")) {
            _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'metaso-csk,';
          }
        }
        if (ai.name === 'é€šä¹‰åƒé—®' && ai.enabled) {
          _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'ty-qw,';
          if (ai.selectedCapability === "deep_thinking") {
            _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'ty-qw-sdsk,';
          } else if (ai.selectedCapability === "web_search") {
            _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'ty-qw-lwss,';
          }
        }
        if (ai.name === 'ç™¾åº¦AI' && ai.enabled) {
          if (_this8.isAiLoginEnabled(ai)) {
            _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'baidu-agent,';
            if (ai.selectedCapabilities.includes("web_search")) {
              _this8.userInfoReq.roles = _this8.userInfoReq.roles + 'baidu-sdss,';
            }
          }
        }
        if (ai.name === "çŸ¥ä¹ç›´ç­”") {
          if (_this8.isAiLoginEnabled(ai)) {
            _this8.userInfoReq.roles = _this8.userInfoReq.roles + "zhzd-chat,";
            // ä½¿ç”¨å•é€‰æ€è€ƒæ¨¡å¼
            if (ai.selectedCapability === "deep_thinking") {
              _this8.userInfoReq.roles = _this8.userInfoReq.roles + "zhzd-sdsk,";
            } else if (ai.selectedCapability === "fast_answer") {
              _this8.userInfoReq.roles = _this8.userInfoReq.roles + "zhzd-ks,";
            } else if (ai.selectedCapability === "smart_thinking") {
              _this8.userInfoReq.roles = _this8.userInfoReq.roles + "zhzd-zn,";
            } else {
              // é»˜è®¤æ™ºèƒ½æ€è€ƒ
              _this8.userInfoReq.roles = _this8.userInfoReq.roles + "zhzd-zn,";
            }
          }
        }
      });
      console.log('ğŸ¯ [sendPrompt] æœ€ç»ˆè§’è‰²å‚æ•°roles:', this.userInfoReq.roles);
      console.log('ğŸ“¦ [sendPrompt] å®Œæ•´è¯·æ±‚å‚æ•°:', JSON.stringify(this.userInfoReq));

      // æ»šåŠ¨åˆ°ä»»åŠ¡çŠ¶æ€åŒºåŸŸ
      this.scrollIntoView = 'task-status';

      //è°ƒç”¨åç«¯æ¥å£
      this.jsonRpcReqest.id = this.generateUUID();
      this.jsonRpcReqest.method = "ä½¿ç”¨F8S";
      this.jsonRpcReqest.params = this.userInfoReq;
      console.log('ğŸ“¡ [sendPrompt] å‡†å¤‡å‘é€JSON-RPCè¯·æ±‚');
      console.log('ğŸ“¡ [sendPrompt] JSON-RPCè¯·æ±‚:', JSON.stringify(this.jsonRpcReqest));
      this.message(this.jsonRpcReqest);
      this.userInfoReq.isNewChat = false;
      console.log('âœ… [sendPrompt] ä»»åŠ¡å·²æäº¤åˆ°åç«¯');
      console.log('ğŸš€ [sendPrompt] ========== ä»»åŠ¡å‘é€å®Œæˆ ==========');
      uni.showToast({
        title: 'ä»»åŠ¡å·²æäº¤',
        icon: 'success'
      });
    },
    // WebSocketç›¸å…³æ–¹æ³•
    initWebSocket: function initWebSocket() {
      var _this9 = this;
      // æ£€æŸ¥ç”¨æˆ·ä¿¡æ¯æ˜¯å¦å®Œæ•´
      if (!this.userId || !this.corpId) {
        console.log('ç”¨æˆ·ä¿¡æ¯ä¸å®Œæ•´ï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢');
        uni.showModal({
          title: 'æç¤º',
          content: 'è¯·å…ˆç™»å½•åå†ä½¿ç”¨',
          showCancel: false,
          confirmText: 'å»ç™»å½•',
          success: function success() {
            uni.navigateTo({
              url: '/pages/login/index'
            });
          }
        });
        return;
      }
      if (this.isConnecting || this.socketTask) {
        console.log('WebSocketæ­£åœ¨è¿æ¥ä¸­æˆ–å·²å­˜åœ¨è¿æ¥ï¼Œè·³è¿‡é‡å¤è¿æ¥');
        return;
      }

      // å…ˆæ¸…ç†å¯èƒ½å­˜åœ¨çš„æ—§è¿æ¥å’Œå®šæ—¶å™¨
      this.closeWebSocket();
      this.isConnecting = true;

      // ä½¿ç”¨PCç«¯çš„WebSocketè¿æ¥æ–¹å¼
      var wsUrl = "".concat(Object({"NODE_ENV":"development","VUE_APP_DARK_MODE":"false","VUE_APP_NAME":"U3W-AI","VUE_APP_PLATFORM":"mp-weixin","BASE_URL":"/"}).VUE_APP_WS_API || 'wss://u3w.com/cubeServer/websocket?clientId=', "mypc-").concat(this.userId);
      // const wsUrl = `${process.env.VUE_APP_WS_API || 'ws://127.0.0.1:8081/websocket?clientId='}mypc-${this.userId}`;
      console.log('WebSocket URL:', wsUrl);
      this.socketTask = uni.connectSocket({
        url: wsUrl,
        success: function success() {
          console.log('WebSocketè¿æ¥æˆåŠŸ');
        },
        fail: function fail(err) {
          console.error('WebSocketè¿æ¥å¤±è´¥', err);
          _this9.isConnecting = false;
          _this9.handleReconnect();
        }
      });
      this.socketTask.onOpen(function () {
        console.log('WebSocketè¿æ¥å·²æ‰“å¼€');
        _this9.isConnecting = false;
        _this9.reconnectCount = 0; // é‡ç½®é‡è¿æ¬¡æ•°

        uni.showToast({
          title: 'è¿æ¥æˆåŠŸ',
          icon: 'success',
          duration: 1000
        });

        // å¼€å§‹å¿ƒè·³æ£€æµ‹
        _this9.startHeartbeat();
      });
      this.socketTask.onMessage(function (res) {
        _this9.handleWebSocketMessage(res.data);
      });
      this.socketTask.onError(function (err) {
        console.error('WebSocketè¿æ¥é”™è¯¯', err);
        _this9.isConnecting = false;
        uni.showToast({
          title: 'WebSocketè¿æ¥é”™è¯¯',
          icon: 'none'
        });
        _this9.handleReconnect();
      });
      this.socketTask.onClose(function () {
        console.log('WebSocketè¿æ¥å·²å…³é—­');
        _this9.isConnecting = false;
        _this9.stopHeartbeat(); // åœæ­¢å¿ƒè·³

        uni.showToast({
          title: 'WebSocketè¿æ¥å·²å…³é—­',
          icon: 'none'
        });

        // å°è¯•é‡è¿
        _this9.handleReconnect();
      });
    },
    // å¤„ç†é‡è¿
    handleReconnect: function handleReconnect() {
      var _this10 = this;
      if (this.reconnectCount >= this.maxReconnectCount) {
        console.log('WebSocketé‡è¿æ¬¡æ•°å·²è¾¾ä¸Šé™');
        uni.showModal({
          title: 'è¿æ¥å¤±è´¥',
          content: 'ç½‘ç»œè¿æ¥ä¸ç¨³å®šï¼Œè¯·æ£€æŸ¥ç½‘ç»œåæ‰‹åŠ¨åˆ·æ–°é¡µé¢',
          showCancel: false,
          confirmText: 'çŸ¥é“äº†'
        });
        return;
      }

      // å¦‚æœå·²ç»åœ¨è¿æ¥ä¸­ï¼Œä¸è¦é‡å¤é‡è¿
      if (this.isConnecting) {
        console.log('WebSocketæ­£åœ¨è¿æ¥ä¸­ï¼Œè·³è¿‡é‡è¿');
        return;
      }
      this.reconnectCount++;
      var delay = Math.min(2000 * Math.pow(2, this.reconnectCount), 30000); // å¢åŠ åŸºç¡€å»¶è¿Ÿåˆ°2ç§’

      console.log("WebSocket\u5C06\u5728".concat(delay, "ms\u540E\u8FDB\u884C\u7B2C").concat(this.reconnectCount, "\u6B21\u91CD\u8FDE"));
      this.reconnectTimer = setTimeout(function () {
        console.log("\u5F00\u59CB\u7B2C".concat(_this10.reconnectCount, "\u6B21\u91CD\u8FDE"));
        _this10.initWebSocket();
      }, delay);
    },
    // å¼€å§‹å¿ƒè·³æ£€æµ‹
    startHeartbeat: function startHeartbeat() {
      var _this11 = this;
      this.stopHeartbeat(); // å…ˆåœæ­¢ä¹‹å‰çš„å¿ƒè·³

      this.heartbeatTimer = setInterval(function () {
        if (_this11.socketTask) {
          _this11.sendWebSocketMessage({
            type: 'HEARTBEAT',
            timestamp: Date.now()
          });
        }
      }, 30000); // æ¯30ç§’å‘é€ä¸€æ¬¡å¿ƒè·³
    },
    // åœæ­¢å¿ƒè·³æ£€æµ‹
    stopHeartbeat: function stopHeartbeat() {
      if (this.heartbeatTimer) {
        clearInterval(this.heartbeatTimer);
        this.heartbeatTimer = null;
      }
    },
    sendWebSocketMessage: function sendWebSocketMessage(data) {
      if (this.socketTask) {
        console.log('å‘é€WebSocketæ¶ˆæ¯:', data);
        this.socketTask.send({
          data: JSON.stringify(data)
        });
      } else {
        console.warn('WebSocketæœªè¿æ¥ï¼Œæ— æ³•å‘é€æ¶ˆæ¯');
      }
    },
    // è°ƒç”¨åç«¯messageæ¥å£
    message: function message(data) {
      console.log('ğŸ“ [message] è°ƒç”¨åç«¯API, æ–¹æ³•:', data.method);
      console.log('ğŸ“ [message] è¯·æ±‚æ•°æ®:', JSON.stringify(data));
      (0, _aigc.message)(data).then(function (res) {
        console.log('ğŸ“ [message] æ”¶åˆ°åç«¯å“åº”, code:', res.code);
        console.log('ğŸ“ [message] å“åº”æ•°æ®:', JSON.stringify(res));
        if (res.code == 201) {
          console.warn('âš ï¸ [message] åç«¯è¿”å›é”™è¯¯, messages:', res.messages);
          uni.showToast({
            title: res.messages,
            icon: 'none',
            duration: 1500
          });
        } else if (res.code == 200) {
          console.log('âœ… [message] åç«¯å¤„ç†æˆåŠŸ');
        }
      }).catch(function (error) {
        console.error('âŒ [message] è°ƒç”¨åç«¯APIå¤±è´¥:', error);
      });
    },
    closeWebSocket: function closeWebSocket() {
      // æ¸…ç†é‡è¿å®šæ—¶å™¨
      if (this.reconnectTimer) {
        clearTimeout(this.reconnectTimer);
        this.reconnectTimer = null;
      }

      // åœæ­¢å¿ƒè·³æ£€æµ‹
      this.stopHeartbeat();

      // å…³é—­WebSocketè¿æ¥
      if (this.socketTask) {
        try {
          this.socketTask.close({
            code: 1000,
            reason: 'æ‰‹åŠ¨å…³é—­è¿æ¥'
          });
        } catch (e) {
          console.log('å…³é—­WebSocketè¿æ¥æ—¶å‡ºé”™:', e);
        }
        this.socketTask = null;
      }

      // é‡ç½®çŠ¶æ€
      this.isConnecting = false;
      this.reconnectCount = 0;
      this.isRefreshing = false; // é‡ç½®åˆ·æ–°æ ‡å¿—
    },
    // å¤„ç†WebSocketæ¶ˆæ¯
    handleWebSocketMessage: function handleWebSocketMessage(data) {
      var _this12 = this;
      try {
        var datastr = data;
        console.log('ğŸ“¨ [WebSocket] æ”¶åˆ°åŸå§‹æ¶ˆæ¯, é•¿åº¦:', datastr.length, 'å­—ç¬¦');
        console.log('ğŸ“¨ [WebSocket] æ¶ˆæ¯å‰200å­—ç¬¦:', datastr.substring(0, 200));
        var dataObj = JSON.parse(datastr);
        console.log('ğŸ“¨ [WebSocket] æ”¶åˆ°æ¶ˆæ¯, ç±»å‹:', dataObj.type);
        console.log('ğŸ“¨ [WebSocket] aiName:', dataObj.aiName);

        // å¿½ç•¥å¿ƒè·³å“åº”
        if (dataObj.type === 'HEARTBEAT_RESPONSE' || dataObj.type === 'HEARTBEAT') {
          return;
        }

        // å¤„ç†chatIdæ¶ˆæ¯
        if (dataObj.type === 'RETURN_YBT1_CHATID' && dataObj.chatId) {
          this.userInfoReq.toneChatId = dataObj.chatId;
        } else if (dataObj.type === 'RETURN_YBDS_CHATID' && dataObj.chatId) {
          this.userInfoReq.ybDsChatId = dataObj.chatId;
        } else if (dataObj.type === 'RETURN_DB_CHATID' && dataObj.chatId) {
          this.userInfoReq.dbChatId = dataObj.chatId;
        }
        // else if (dataObj.type === 'RETURN_TY_CHATID' && dataObj.chatId) {
        //   this.userInfoReq.tyChatId = dataObj.chatId;
        // }
        else if (dataObj.type === "RETURN_METASO_CHATID" && dataObj.chatId) {
          this.userInfoReq.metasoChatId = dataObj.chatId;
        }

        // å¤„ç†è¿›åº¦æ—¥å¿—æ¶ˆæ¯
        if (dataObj.type === 'RETURN_PC_TASK_LOG' && dataObj.aiName) {
          console.log("\uD83D\uDCCB [\u8FDB\u5EA6\u65E5\u5FD7] AI: ".concat(dataObj.aiName, ", \u5185\u5BB9: ").concat(dataObj.content));

          // åªå¤„ç†å½“å‰ä»»åŠ¡çš„æ—¥å¿—æ¶ˆæ¯
          if (dataObj.taskId && dataObj.taskId !== this.userInfoReq.taskId) {
            console.log("\u26A0\uFE0F [\u8FDB\u5EA6\u65E5\u5FD7] \u5FFD\u7565\u5176\u4ED6\u4EFB\u52A1\u7684\u65E5\u5FD7");
            return;
          }
          var targetAI = this.enabledAIs.find(function (ai) {
            return ai.name === dataObj.aiName;
          });
          if (targetAI && targetAI.status === 'running') {
            console.log("\u2705 [\u8FDB\u5EA6\u65E5\u5FD7] \u627E\u5230\u76EE\u6807AI: ".concat(targetAI.name, ", \u6DFB\u52A0\u8FDB\u5EA6\u65E5\u5FD7"));
            // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨ç›¸åŒå†…å®¹çš„æ—¥å¿—ï¼Œé¿å…é‡å¤æ·»åŠ 
            var existingLog = targetAI.progressLogs.find(function (log) {
              return log.content === dataObj.content;
            });
            if (!existingLog) {
              // å°†æ–°è¿›åº¦æ·»åŠ åˆ°æ•°ç»„å¼€å¤´
              targetAI.progressLogs.unshift({
                content: dataObj.content,
                timestamp: new Date(),
                isCompleted: false,
                taskId: this.userInfoReq.taskId
              });
              console.log("\uD83D\uDCCA [\u8FDB\u5EA6\u65E5\u5FD7] ".concat(targetAI.name, "\u5F53\u524D\u8FDB\u5EA6\u65E5\u5FD7\u6570\u91CF: ").concat(targetAI.progressLogs.length));
            }
          } else {
            console.warn("\u26A0\uFE0F [\u8FDB\u5EA6\u65E5\u5FD7] \u672A\u627E\u5230AI\u6216AI\u672A\u5728\u8FD0\u884C: ".concat(dataObj.aiName));
          }
          return;
        }

        // å¤„ç†æˆªå›¾æ¶ˆæ¯
        if (dataObj.type === 'RETURN_PC_TASK_IMG' && dataObj.url) {
          // åªå¤„ç†å½“å‰ä»»åŠ¡çš„æˆªå›¾
          if (dataObj.taskId && dataObj.taskId !== this.userInfoReq.taskId) {
            return;
          }
          // å°†æ–°çš„æˆªå›¾æ·»åŠ åˆ°æ•°ç»„å¼€å¤´
          this.screenshots.unshift(dataObj.url);
          return;
        }

        // å¤„ç†æ™ºèƒ½è¯„åˆ†ç»“æœ
        if (dataObj.type === 'RETURN_WKPF_RES') {
          console.log("âœ… æ”¶åˆ°æ™ºèƒ½è¯„åˆ†ç»“æœ", dataObj);
          var wkpfAI = this.enabledAIs.find(function (ai) {
            return ai.name === 'æ™ºèƒ½è¯„åˆ†';
          });
          if (wkpfAI) {
            wkpfAI.status = 'completed';
            if (wkpfAI.progressLogs.length > 0) {
              wkpfAI.progressLogs[0].isCompleted = true;
            }

            // æ·»åŠ è¯„åˆ†ç»“æœåˆ°resultsæœ€å‰é¢
            this.results.unshift({
              aiName: 'æ™ºèƒ½è¯„åˆ†',
              content: dataObj.draftContent,
              shareUrl: dataObj.shareUrl || '',
              shareImgUrl: dataObj.shareImgUrl || '',
              timestamp: new Date()
            });
            this.activeResultIndex = 0;

            // æŠ˜å æ‰€æœ‰åŒºåŸŸ
            this.sectionExpanded.aiConfig = false;
            this.sectionExpanded.promptInput = false;
            this.sectionExpanded.taskStatus = false;

            // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
            this.scrollIntoView = 'results';

            // æ™ºèƒ½è¯„åˆ†å®Œæˆæ—¶ï¼Œä¿å­˜å†å²è®°å½•
            this.saveHistory();
            uni.showToast({
              title: 'æ™ºèƒ½è¯„åˆ†å®Œæˆ',
              icon: 'success',
              duration: 2000
            });
            console.log('âœ… æ™ºèƒ½è¯„åˆ†ç»“æœå¤„ç†å®Œæˆ');
          }
          return;
        }

        // å¤„ç†æ™ºèƒ½æ’ç‰ˆç»“æœ
        if (dataObj.type === 'RETURN_ZNPB_RES') {
          console.log("æ”¶åˆ°æ™ºèƒ½æ’ç‰ˆç»“æœ", dataObj);
          console.log("å½“å‰ selectedMedia:", this.selectedMedia);
          var znpbAI = this.enabledAIs.find(function (ai) {
            return ai.name === 'æ™ºèƒ½æ’ç‰ˆ';
          });
          if (znpbAI) {
            znpbAI.status = 'completed';
            if (znpbAI.progressLogs.length > 0) {
              znpbAI.progressLogs[0].isCompleted = true;
            }

            // æ ¹æ®selectedMediaè·å–åª’ä½“åç§°æ ‡ç­¾
            var mediaItem = this.mediaList.find(function (media) {
              return media.name === _this12.selectedMedia;
            });
            var mediaLabel = mediaItem ? mediaItem.label : '';

            // æ·»åŠ æ’ç‰ˆç»“æœåˆ°ç»“æœå±•ç¤ºï¼ŒaiNameåŒ…å«åª’ä½“ç±»å‹
            this.results.unshift({
              aiName: 'æ™ºèƒ½æ’ç‰ˆ' + mediaLabel,
              content: dataObj.draftContent,
              shareUrl: dataObj.shareUrl || '',
              shareImgUrl: dataObj.shareImgUrl || '',
              timestamp: new Date()
            });
            this.activeResultIndex = 0;

            // æŠ˜å æ‰€æœ‰åŒºåŸŸ
            this.sectionExpanded.aiConfig = false;
            this.sectionExpanded.promptInput = false;
            this.sectionExpanded.taskStatus = false;

            // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
            this.scrollIntoView = 'results';

            // æ™ºèƒ½æ’ç‰ˆå®Œæˆæ—¶ï¼Œä¿å­˜å†å²è®°å½•
            this.saveHistory();
            uni.showToast({
              title: "".concat(mediaLabel, "\u6392\u7248\u5B8C\u6210\uFF0C\u53EF\u624B\u52A8\u6295\u9012"),
              icon: 'success'
            });
          }
          return;
        }
        // å¤„ç†åª’ä½“æŠ•é€’ä»»åŠ¡æ—¥å¿—
        if (dataObj.type === 'RETURN_MEDIA_TASK_LOG') {
          console.log("æ”¶åˆ°åª’ä½“ä»»åŠ¡æ—¥å¿—", dataObj);
          var mediaAI = this.enabledAIs.find(function (ai) {
            return ai.name === 'åª’ä½“æŠ•é€’';
          });
          if (mediaAI && mediaAI.status === 'running') {
            // åªåœ¨è¿è¡ŒçŠ¶æ€æ—¶æ·»åŠ æ—¥å¿—
            // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨ç›¸åŒå†…å®¹çš„æ—¥å¿—ï¼Œé¿å…é‡å¤æ·»åŠ 
            var _existingLog = mediaAI.progressLogs.find(function (log) {
              return log.content === dataObj.content;
            });
            if (!_existingLog) {
              // å°†æ–°è¿›åº¦æ·»åŠ åˆ°æ•°ç»„å¼€å¤´
              mediaAI.progressLogs.unshift({
                content: dataObj.content,
                timestamp: new Date(),
                isCompleted: false,
                type: 'åª’ä½“æŠ•é€’'
              });

              // å¼ºåˆ¶æ›´æ–°UI
              this.$forceUpdate();
            }
          }
          return;
        }

        // å¤„ç†åª’ä½“æŠ•é€’ç»“æœï¼ˆåŒ…æ‹¬çŸ¥ä¹ã€ç™¾å®¶å·ç­‰ï¼‰
        if (dataObj.type.includes('DELIVERY_RES')) {
          console.log("æ”¶åˆ°åª’ä½“æŠ•é€’å®Œæˆç»“æœ", dataObj);
          var _mediaAI = this.enabledAIs.find(function (ai) {
            return ai.name === 'åª’ä½“æŠ•é€’';
          });
          if (_mediaAI) {
            _mediaAI.status = 'completed';
            if (_mediaAI.progressLogs.length > 0) {
              _mediaAI.progressLogs[0].isCompleted = true;
            }
          }
          uni.showToast({
            title: dataObj.message || 'åª’ä½“æŠ•é€’å®Œæˆ',
            icon: 'success'
          });
          return;
        }

        // å¤„ç†å¾®å¤´æ¡æ’ç‰ˆç»“æœ
        if (dataObj.type === 'RETURN_TTH_ZNPB_RES') {
          // è®¾ç½®å¾®å¤´æ¡æ’ç‰ˆAIèŠ‚ç‚¹çŠ¶æ€ä¸ºcompleted
          var tthZnpbAI = this.enabledAIs.find(function (ai) {
            return ai.name === 'å¾®å¤´æ¡æ’ç‰ˆ';
          });
          if (tthZnpbAI) {
            tthZnpbAI.status = 'completed';
            if (tthZnpbAI.progressLogs.length > 0) {
              tthZnpbAI.progressLogs[0].isCompleted = true;
            }
          }
          this.tthArticleTitle = dataObj.title || '';
          this.tthArticleContent = dataObj.content || '';
          this.tthArticleEditVisible = true;

          // ç¡®ä¿textareaæ­£ç¡®æ˜¾ç¤ºå†…å®¹
          this.$nextTick(function () {
            // å¼ºåˆ¶æ›´æ–°textareaå†…å®¹
            var textarea = _this12.$el.querySelector('.score-textarea');
            if (textarea) {
              textarea.value = _this12.tthArticleContent;
              // è§¦å‘inputäº‹ä»¶ç¡®ä¿v-modelåŒæ­¥
              textarea.dispatchEvent(new Event('input', {
                bubbles: true
              }));
            }
          });
          if (this.saveHistory) {
            this.saveHistory();
          }
          uni.showToast({
            title: 'å¾®å¤´æ¡æ’ç‰ˆå®Œæˆï¼Œè¯·ç¡®è®¤æ ‡é¢˜å’Œå†…å®¹',
            icon: 'success'
          });
          return;
        }

        // å¤„ç†å¾®å¤´æ¡å‘å¸ƒæµç¨‹
        if (dataObj.type === 'RETURN_TTH_FLOW') {
          if (dataObj.content) {
            this.tthFlowLogs.push({
              content: dataObj.content,
              timestamp: new Date(),
              type: 'flow'
            });
          }
          if (dataObj.shareImgUrl) {
            this.tthFlowImages.push(dataObj.shareImgUrl);
          }
          if (!this.tthFlowVisible) {
            this.tthFlowVisible = true;
          }
          if (dataObj.content === 'success') {
            uni.showToast({
              title: 'å‘å¸ƒåˆ°å¾®å¤´æ¡æˆåŠŸï¼',
              icon: 'success'
            });
            this.tthFlowVisible = true;
          }
          if (dataObj.content === 'fail') {
            uni.showToast({
              title: 'å‘å¸ƒåˆ°å¾®å¤´æ¡å¤±è´¥ï¼',
              icon: 'none'
            });
            this.tthFlowVisible = false;
            this.tthArticleEditVisible = true;
          }
          return;
        }

        // å¤„ç†AIç™»å½•çŠ¶æ€æ¶ˆæ¯
        console.log('ğŸ” [çŠ¶æ€æ£€æŸ¥] æ£€æŸ¥AIç™»å½•çŠ¶æ€æ¶ˆæ¯');
        this.handleAiStatusMessage(datastr, dataObj);

        // å¤„ç†AIç»“æœ
        console.log('ğŸ¯ [ç»“æœå¤„ç†] è°ƒç”¨handleAIResultå¤„ç†AIç»“æœ');
        this.handleAIResult(dataObj);
      } catch (error) {
        console.error('âŒ WebSocketæ¶ˆæ¯å¤„ç†é”™è¯¯:', error);
        console.error('âŒ é”™è¯¯å †æ ˆ:', error.stack);
        console.error('âŒ æ¶ˆæ¯é•¿åº¦:', data ? data.length : 0);

        // å°è¯•æ˜¾ç¤ºé”™è¯¯æç¤º
        uni.showToast({
          title: 'æ¶ˆæ¯å¤„ç†å¤±è´¥:' + error.message,
          icon: 'none',
          duration: 3000
        });
      }
    },
    handleAiStatusMessage: function handleAiStatusMessage(datastr, dataObj) {
      // å¤„ç†è…¾è®¯å…ƒå®ç™»å½•çŠ¶æ€
      if (datastr.includes("RETURN_YB_STATUS") && dataObj.status != '') {
        this.isLoading.yuanbao = false;
        if (!datastr.includes("false")) {
          this.aiLoginStatus.yuanbao = true;
          this.accounts.yuanbao = dataObj.status;
        } else {
          this.aiLoginStatus.yuanbao = false;
          // ç¦ç”¨ç›¸å…³AI
          this.disableAIsByLoginStatus('yuanbao');
        }
        // æ›´æ–°AIå¯ç”¨çŠ¶æ€
        this.updateAiEnabledStatus();
      }
      // å¤„ç†è±†åŒ…ç™»å½•çŠ¶æ€
      if (datastr.includes("RETURN_DB_STATUS") && dataObj.status != '') {
        this.isLoading.doubao = false;
        if (!datastr.includes("false")) {
          this.aiLoginStatus.doubao = true;
          this.accounts.doubao = dataObj.status;
        } else {
          this.aiLoginStatus.doubao = false;
          // ç¦ç”¨ç›¸å…³AI
          this.disableAIsByLoginStatus('doubao');
        }
        // æ›´æ–°AIå¯ç”¨çŠ¶æ€
        this.updateAiEnabledStatus();
      }

      // å¤„ç†ç§˜å¡”ç™»å½•çŠ¶æ€
      else if (datastr.includes("RETURN_METASO_STATUS") && dataObj.status != "") {
        this.isLoading.metaso = false;
        if (!datastr.includes("false")) {
          this.aiLoginStatus.metaso = true;
          this.accounts.metaso = dataObj.status;
        } else {
          this.aiLoginStatus.metaso = false;
          // ç¦ç”¨ç›¸å…³AI
          this.disableAIsByLoginStatus("metaso");
        }
        // æ›´æ–°AIå¯ç”¨çŠ¶æ€
        this.updateAiEnabledStatus();
      }
      // å¤„ç†DeepSeekç™»å½•çŠ¶æ€
      else if (datastr.includes("RETURN_DEEPSEEK_STATUS")) {
        console.log("æ”¶åˆ°DeepSeekç™»å½•çŠ¶æ€æ¶ˆæ¯:", dataObj);
        this.isLoading.deepseek = false;
        if (dataObj.status && dataObj.status !== 'false' && dataObj.status !== '') {
          this.aiLoginStatus.deepseek = true;
          this.accounts.deepseek = dataObj.status;
          console.log("DeepSeekç™»å½•æˆåŠŸï¼Œè´¦å·:", dataObj.status);

          // æŸ¥æ‰¾DeepSeek AIå®ä¾‹
          var deepseekAI = this.aiList.find(function (ai) {
            return ai.name === 'DeepSeek';
          });
        } else {
          this.aiLoginStatus.deepseek = false;
          this.accounts.deepseek = '';
          console.log("DeepSeekæœªç™»å½•");

          // å¦‚æœæœªç™»å½•ï¼Œç¡®ä¿DeepSeekè¢«ç¦ç”¨
          var _deepseekAI = this.aiList.find(function (ai) {
            return ai.name === 'DeepSeek';
          });
        }
        // å¼ºåˆ¶æ›´æ–°UI
        this.$forceUpdate();
      } else if (datastr.includes("RETURN_TY_STATUS") && dataObj.status != "") {
        this.isLoading.tongyi = false;
        if (!datastr.includes("false")) {
          this.aiLoginStatus.tongyi = true;
          this.accounts.tongyi = dataObj.status;
        } else {
          this.aiLoginStatus.tongyi = false;
          // ç¦ç”¨ç›¸å…³AI
          this.disableAIsByLoginStatus("tongyi");
        }
        // æ›´æ–°AIå¯ç”¨çŠ¶æ€
        this.updateAiEnabledStatus();
      }

      // å¤„ç†çŸ¥ä¹ç›´ç­”ç™»å½•çŠ¶æ€
      else if (datastr.includes("RETURN_ZHZD_STATUS") && dataObj.status != "") {
        console.log('æ”¶åˆ°çŸ¥ä¹ç›´ç­”ç™»å½•çŠ¶æ€å“åº”:', datastr, dataObj);
        this.isLoading.zhzd = false;
        if (!datastr.includes("false")) {
          this.aiLoginStatus.zhzd = true;
          this.accounts.zhzd = dataObj.status;
        } else {
          this.aiLoginStatus.zhzd = false;
          // ç¦ç”¨ç›¸å…³AI
          this.disableAIsByLoginStatus("zhzd");
        }
        // æ›´æ–°AIå¯ç”¨çŠ¶æ€
        this.updateAiEnabledStatus();
      }
      // å¤„ç†ç™¾åº¦AIç™»å½•çŠ¶æ€
      else if (datastr.includes("RETURN_BAIDU_STATUS") && dataObj.status != "") {
        this.isLoading.baidu = false;
        if (!datastr.includes("false")) {
          this.aiLoginStatus.baidu = true;
          this.accounts.baidu = dataObj.status;
        } else {
          this.aiLoginStatus.baidu = false;
          // ç¦ç”¨ç›¸å…³AI
          this.disableAIsByLoginStatus("baidu");
        }
        // æ›´æ–°AIå¯ç”¨çŠ¶æ€
        this.updateAiEnabledStatus();
      }
    },
    handleAIResult: function handleAIResult(dataObj) {
      var _this13 = this;
      console.log('ğŸ” [handleAIResult] å¼€å§‹å¤„ç†AIç»“æœ, æ¶ˆæ¯ç±»å‹:', dataObj.type);
      console.log('ğŸ” [handleAIResult] å®Œæ•´æ•°æ®å¯¹è±¡:', JSON.stringify(dataObj));
      console.log('ğŸ” [handleAIResult] å½“å‰enabledAIsæ•°é‡:', this.enabledAIs.length);
      console.log('ğŸ” [handleAIResult] enabledAIsåˆ—è¡¨:', this.enabledAIs.map(function (ai) {
        return "".concat(ai.name, "(").concat(ai.status, ")");
      }).join(', '));
      var targetAI = null;

      // æ ¹æ®æ¶ˆæ¯ç±»å‹åŒ¹é…AI
      switch (dataObj.type) {
        case 'RETURN_YBT1_RES':
          console.log('âœ… åŒ¹é…åˆ°è…¾è®¯å…ƒå®æ··å…ƒæ¶ˆæ¯');
          targetAI = this.enabledAIs.find(function (ai) {
            return ai.name === 'è…¾è®¯å…ƒå®';
          });
          break;
        case 'RETURN_YBDS_RES':
          console.log('âœ… åŒ¹é…åˆ°è…¾è®¯å…ƒå®DeepSeekæ¶ˆæ¯');
          targetAI = this.enabledAIs.find(function (ai) {
            return ai.name === 'è…¾è®¯å…ƒå®';
          });
          break;
        case 'RETURN_DB_RES':
          console.log('âœ… åŒ¹é…åˆ°è±†åŒ…æ¶ˆæ¯');
          targetAI = this.enabledAIs.find(function (ai) {
            return ai.name === 'è±†åŒ…';
          });
          break;
        case 'RETURN_DEEPSEEK_RES':
          console.log('âœ… åŒ¹é…åˆ°DeepSeekæ¶ˆæ¯');
          targetAI = this.enabledAIs.find(function (ai) {
            return ai.name === 'DeepSeek';
          });
          // å¦‚æœæ‰¾ä¸åˆ°DeepSeekï¼Œå¯èƒ½æ˜¯å› ä¸ºå®ƒä¸åœ¨enabledAIsä¸­ï¼ˆå…¼å®¹å¤„ç†ï¼‰
          if (!targetAI) {
            console.warn('âš ï¸ DeepSeekä¸åœ¨enabledAIsä¸­ï¼ŒåŠ¨æ€æ·»åŠ ');
            targetAI = {
              name: 'DeepSeek',
              avatar: 'https://u3w.com/chatfile/Deepseek.png',
              capabilities: [{
                label: 'æ·±åº¦æ€è€ƒ',
                value: 'deep_thinking'
              }, {
                label: 'è”ç½‘æœç´¢',
                value: 'web_search'
              }],
              selectedCapabilities: ['deep_thinking', 'web_search'],
              enabled: true,
              status: 'running',
              progressLogs: [{
                content: 'DeepSeekå“åº”å·²æ¥æ”¶',
                timestamp: new Date(),
                isCompleted: false
              }],
              isExpanded: true
            };
            this.enabledAIs.unshift(targetAI);
          }
          break;
        case 'RETURN_ZNPB_RES':
          console.log('âœ… åŒ¹é…åˆ°æ™ºèƒ½æ’ç‰ˆç»“æœæ¶ˆæ¯');
          // æ™ºèƒ½æ’ç‰ˆç»“æœï¼Œæ‰¾åˆ°"æ™ºèƒ½æ’ç‰ˆ"AI
          targetAI = this.enabledAIs.find(function (ai) {
            return ai.name === 'æ™ºèƒ½æ’ç‰ˆ';
          });
          if (!targetAI) {
            console.warn('âš ï¸ æ™ºèƒ½æ’ç‰ˆAIä¸åœ¨enabledAIsä¸­ï¼ŒåŠ¨æ€æ·»åŠ ');
            targetAI = {
              name: 'æ™ºèƒ½æ’ç‰ˆ',
              avatar: 'https://u3w.com/chatfile/Deepseek.png',
              capabilities: [],
              selectedCapabilities: [],
              enabled: true,
              status: 'running',
              progressLogs: [{
                content: 'æ™ºèƒ½æ’ç‰ˆå“åº”å·²æ¥æ”¶',
                timestamp: new Date(),
                isCompleted: false
              }],
              isExpanded: true
            };
            this.enabledAIs.unshift(targetAI);
          }
          break;
        case 'RETURN_TY_RES':
          console.log('âœ… åŒ¹é…åˆ°é€šä¹‰åƒé—®æ¶ˆæ¯');
          targetAI = this.enabledAIs.find(function (ai) {
            return ai.name === 'é€šä¹‰åƒé—®';
          });
          break;
        case 'RETURN_METASO_RES':
          console.log('âœ… åŒ¹é…åˆ°ç§˜å¡”æ¶ˆæ¯');
          targetAI = this.enabledAIs.find(function (ai) {
            return ai.name === "ç§˜å¡”";
          });
          break;
        case 'RETURN_ZHZD_RES':
          console.log('âœ… åŒ¹é…åˆ°çŸ¥ä¹ç›´ç­”æ¶ˆæ¯');
          targetAI = this.enabledAIs.find(function (ai) {
            return ai.name === 'çŸ¥ä¹ç›´ç­”';
          });
          break;
        case 'RETURN_BAIDU_RES':
          console.log('âœ… åŒ¹é…åˆ°ç™¾åº¦AIæ¶ˆæ¯');
          targetAI = this.enabledAIs.find(function (ai) {
            return ai.name === 'ç™¾åº¦AI';
          });
          break;
        default:
          console.log('âš ï¸ æœªåŒ¹é…åˆ°ä»»ä½•AIç±»å‹, æ¶ˆæ¯ç±»å‹:', dataObj.type);
          return;
      }
      if (targetAI) {
        console.log("\u2705 \u627E\u5230\u76EE\u6807AI: ".concat(targetAI.name, ", \u5F53\u524D\u72B6\u6001: ").concat(targetAI.status));

        // åªå¤„ç†å½“å‰ä»»åŠ¡çš„ç»“æœ
        if (dataObj.taskId && dataObj.taskId !== this.userInfoReq.taskId) {
          console.log("\u26A0\uFE0F \u5FFD\u7565\u5176\u4ED6\u4EFB\u52A1\u7684\u6D88\u606F, \u5F53\u524DtaskId: ".concat(this.userInfoReq.taskId, ", \u6D88\u606FtaskId: ").concat(dataObj.taskId));
          return;
        }

        // æ£€æŸ¥AIæ˜¯å¦è¿˜åœ¨è¿è¡ŒçŠ¶æ€ï¼Œé¿å…é‡å¤å¤„ç†
        if (targetAI.status !== 'running') {
          console.log("\u26A0\uFE0F AI\u72B6\u6001\u4E0D\u662Frunning\uFF0C\u8DF3\u8FC7\u5904\u7406, \u5F53\u524D\u72B6\u6001: ".concat(targetAI.status));
          return;
        }

        // æ›´æ–°AIçŠ¶æ€ä¸ºå·²å®Œæˆ
        targetAI.status = 'completed';
        console.log("\uD83D\uDD04 \u66F4\u65B0".concat(targetAI.name, "\u72B6\u6001\u4E3A: completed"));

        // å°†æœ€åä¸€æ¡è¿›åº¦æ¶ˆæ¯æ ‡è®°ä¸ºå·²å®Œæˆ
        if (targetAI.progressLogs.length > 0) {
          targetAI.progressLogs[0].isCompleted = true;
          console.log("\uD83D\uDCDD \u6807\u8BB0".concat(targetAI.name, "\u6700\u540E\u4E00\u6761\u8FDB\u5EA6\u65E5\u5FD7\u4E3A\u5DF2\u5B8C\u6210"));
        }

        // æ·»åŠ ç»“æœåˆ°æ•°ç»„å¼€å¤´
        var resultIndex = this.results.findIndex(function (r) {
          return r.aiName === targetAI.name && r.taskId === _this13.userInfoReq.taskId;
        });
        console.log("\uD83D\uDD0D \u68C0\u67E5results\u4E2D\u662F\u5426\u5DF2\u5B58\u5728".concat(targetAI.name, "\u7684\u7ED3\u679C, \u7D22\u5F15: ").concat(resultIndex));
        if (resultIndex === -1) {
          console.log("\u2795 \u6DFB\u52A0".concat(targetAI.name, "\u7684\u65B0\u7ED3\u679C\u5230results"));
          this.results.unshift({
            aiName: targetAI.name,
            content: dataObj.draftContent,
            shareUrl: dataObj.shareUrl || '',
            shareImgUrl: dataObj.shareImgUrl || '',
            timestamp: new Date(),
            taskId: this.userInfoReq.taskId
          });
          this.activeResultIndex = 0;
        } else {
          console.log("\uD83D\uDD04 \u66FF\u6362".concat(targetAI.name, "\u7684\u73B0\u6709\u7ED3\u679C"));
          this.results.splice(resultIndex, 1);
          this.results.unshift({
            aiName: targetAI.name,
            content: dataObj.draftContent,
            shareUrl: dataObj.shareUrl || '',
            shareImgUrl: dataObj.shareImgUrl || '',
            timestamp: new Date(),
            taskId: this.userInfoReq.taskId
          });
          this.activeResultIndex = 0;
        }
        console.log("\uD83D\uDCCA \u5F53\u524Dresults\u6570\u91CF: ".concat(this.results.length));
        console.log("\uD83D\uDCCA results\u5217\u8868:", this.results.map(function (r) {
          return r.aiName;
        }).join(', '));

        // æŠ˜å æ‰€æœ‰åŒºåŸŸå½“æœ‰ç»“æœè¿”å›æ—¶
        this.sectionExpanded.aiConfig = false;
        this.sectionExpanded.promptInput = false;
        this.sectionExpanded.taskStatus = false;
        console.log('ğŸ“ æŠ˜å æ‰€æœ‰é…ç½®åŒºåŸŸ');

        // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
        this.scrollIntoView = 'results';
        console.log('ğŸ“œ è®¾ç½®æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ');

        // ä¿å­˜å†å²è®°å½•
        this.saveHistory();
        console.log('ğŸ’¾ ä¿å­˜å†å²è®°å½•');
        console.log("\u2705 ".concat(targetAI.name, "\u7ED3\u679C\u5904\u7406\u5B8C\u6210"));
      } else {
        console.error("\u274C \u672A\u627E\u5230\u5BF9\u5E94\u7684AI, \u6D88\u606F\u7C7B\u578B: ".concat(dataObj.type));
        console.error('âŒ å¯èƒ½çš„åŸå› : 1) AIæœªå¯ç”¨ 2) AIåç§°ä¸åŒ¹é… 3) enabledAIsä¸ºç©º');
      }
    },
    // çŠ¶æ€ç›¸å…³æ–¹æ³•
    getStatusText: function getStatusText(status) {
      var statusMap = {
        'idle': 'ç­‰å¾…ä¸­',
        'running': 'æ­£åœ¨æ‰§è¡Œ',
        'completed': 'å·²å®Œæˆ',
        'failed': 'æ‰§è¡Œå¤±è´¥'
      };
      return statusMap[status] || 'æœªçŸ¥çŠ¶æ€';
    },
    getStatusIconClass: function getStatusIconClass(status) {
      var classMap = {
        'idle': 'status-idle',
        'running': 'status-running',
        'completed': 'status-completed',
        'failed': 'status-failed'
      };
      return classMap[status] || 'status-unknown';
    },
    getStatusEmoji: function getStatusEmoji(status) {
      var emojiMap = {
        'idle': 'â³',
        'running': 'ğŸ”„',
        'completed': 'âœ…',
        'failed': 'âŒ'
      };
      return emojiMap[status] || 'â“';
    },
    // åˆ‡æ¢ä»»åŠ¡å±•å¼€çŠ¶æ€
    toggleTaskExpansion: function toggleTaskExpansion(ai) {
      ai.isExpanded = !ai.isExpanded;
    },
    // åˆ‡æ¢è‡ªåŠ¨æ’­æ”¾
    toggleAutoPlay: function toggleAutoPlay(event) {
      this.autoPlay = event.detail.value;
    },
    // é¢„è§ˆå›¾ç‰‡
    previewImage: function previewImage(url) {
      uni.previewImage({
        current: url,
        urls: [url]
      });
    },
    // ç»“æœç›¸å…³æ–¹æ³•
    switchResultTab: function switchResultTab(index) {
      this.activeResultIndex = index;
    },
    renderMarkdown: function renderMarkdown(text) {
      try {
        // å¯¹äºDeepSeekå“åº”ï¼Œæ·»åŠ ç‰¹æ®Šçš„CSSç±»
        if (this.currentResult && this.currentResult.aiName === 'DeepSeek') {
          // æ£€æŸ¥æ˜¯å¦å·²ç»åŒ…å«äº†deepseek-responseç±»
          if (text && text.includes('class="deepseek-response"')) {
            return text; // å·²ç»åŒ…å«äº†ç‰¹æ®Šç±»ï¼Œç›´æ¥è¿”å›
          }

          var renderedHtml = (0, _marked.marked)(text);
          return "<div class=\"deepseek-response\">".concat(renderedHtml, "</div>");
        }
        return (0, _marked.marked)(text);
      } catch (error) {
        return text;
      }
    },
    isImageFile: function isImageFile(url) {
      if (!url) return false;
      var imageExtensions = ['.jpg', '.jpeg', '.png', '.gif', '.bmp', '.webp', '.svg'];
      var urlLower = url.toLowerCase();
      return imageExtensions.some(function (ext) {
        return urlLower.includes(ext);
      });
    },
    // åˆ¤æ–­æ˜¯å¦ä¸ºPDFæ–‡ä»¶
    isPdfFile: function isPdfFile(url) {
      if (!url) return false;
      return url.toLowerCase().includes('.pdf');
    },
    copyResult: function copyResult(content) {
      uni.setClipboardData({
        data: content,
        success: function success() {
          uni.showToast({
            title: 'å·²å¤åˆ¶åˆ°å‰ªè´´æ¿',
            icon: 'success'
          });
        }
      });
    },
    // shareResult(result) {
    // 	uni.share({
    // 		provider: 'weixin',
    // 		scene: 'WXSceneSession',
    // 		type: 0,
    // 		title: `${result.aiName}çš„æ‰§è¡Œç»“æœ`,
    // 		summary: result.content.substring(0, 100),
    // 		success: () => {
    // 			uni.showToast({
    // 				title: 'åˆ†äº«æˆåŠŸ',
    // 				icon: 'success'
    // 			});
    // 		}
    // 	});
    // },
    exportResult: function exportResult(result) {
      // å°ç¨‹åºç¯å¢ƒä¸‹çš„å¯¼å‡ºåŠŸèƒ½å¯ä»¥é€šè¿‡åˆ†äº«æˆ–å¤åˆ¶å®ç°
      this.copyResult(result.content);
    },
    openShareUrl: function openShareUrl(url) {
      uni.setClipboardData({
        data: url,
        success: function success() {
          uni.showToast({
            title: 'åŸé“¾æ¥å·²å¤åˆ¶',
            icon: 'success'
          });
        },
        fail: function fail() {
          uni.showToast({
            title: 'å¤åˆ¶å¤±è´¥',
            icon: 'none'
          });
        }
      });
    },
    // å¤åˆ¶PDFé“¾æ¥
    copyPdfUrl: function copyPdfUrl(url) {
      uni.setClipboardData({
        data: url,
        success: function success() {
          uni.showToast({
            title: 'PDFé“¾æ¥å·²å¤åˆ¶',
            icon: 'success'
          });
        },
        fail: function fail() {
          uni.showToast({
            title: 'å¤åˆ¶å¤±è´¥',
            icon: 'none'
          });
        }
      });
    },
    // æ‰“å¼€PDFæ–‡ä»¶
    openPdfFile: function openPdfFile(url) {
      uni.showLoading({
        title: 'æ­£åœ¨ä¸‹è½½PDF...'
      });

      // å°è¯•ä¸‹è½½å¹¶æ‰“å¼€æ–‡ä»¶
      uni.downloadFile({
        url: url,
        success: function success(res) {
          uni.hideLoading();
          if (res.statusCode === 200) {
            // æ‰“å¼€æ–‡ä»¶
            uni.openDocument({
              filePath: res.tempFilePath,
              success: function success() {
                uni.showToast({
                  title: 'PDFå·²æ‰“å¼€',
                  icon: 'success'
                });
              },
              fail: function fail() {
                // å¦‚æœæ— æ³•æ‰“å¼€ï¼Œæç¤ºå¹¶å¤åˆ¶é“¾æ¥
                uni.showModal({
                  title: 'æç¤º',
                  content: 'æ— æ³•åœ¨å½“å‰ç¯å¢ƒæ‰“å¼€PDFæ–‡ä»¶ï¼Œå·²å¤åˆ¶é“¾æ¥åˆ°å‰ªè´´æ¿ï¼Œè¯·åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€',
                  showCancel: false,
                  success: function success() {
                    uni.setClipboardData({
                      data: url
                    });
                  }
                });
              }
            });
          } else {
            uni.showToast({
              title: 'ä¸‹è½½å¤±è´¥',
              icon: 'none'
            });
          }
        },
        fail: function fail() {
          uni.hideLoading();
          // ä¸‹è½½å¤±è´¥ï¼Œæç¤ºå¹¶å¤åˆ¶é“¾æ¥
          uni.showModal({
            title: 'æç¤º',
            content: 'ä¸‹è½½å¤±è´¥ï¼Œå·²å¤åˆ¶PDFé“¾æ¥åˆ°å‰ªè´´æ¿ï¼Œè¯·åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€',
            showCancel: false,
            success: function success() {
              uni.setClipboardData({
                data: url
              });
            }
          });
        }
      });
    },
    // å†å²è®°å½•ç›¸å…³æ–¹æ³•
    showHistoryDrawer: function showHistoryDrawer() {
      this.historyDrawerVisible = true;
      this.loadChatHistory(1);
    },
    closeHistoryDrawer: function closeHistoryDrawer() {
      this.historyDrawerVisible = false;
    },
    loadChatHistory: function loadChatHistory(isAll) {
      var _this14 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee4() {
        var res;
        return _regenerator.default.wrap(function _callee4$(_context4) {
          while (1) {
            switch (_context4.prev = _context4.next) {
              case 0:
                _context4.prev = 0;
                _context4.next = 3;
                return (0, _aigc.getChatHistory)(_this14.userId, isAll);
              case 3:
                res = _context4.sent;
                if (res.code === 200) {
                  _this14.chatHistory = res.data || [];
                }
                _context4.next = 11;
                break;
              case 7:
                _context4.prev = 7;
                _context4.t0 = _context4["catch"](0);
                console.error('åŠ è½½å†å²è®°å½•å¤±è´¥:', _context4.t0);
                uni.showToast({
                  title: 'åŠ è½½å†å²è®°å½•å¤±è´¥',
                  icon: 'none'
                });
              case 11:
              case "end":
                return _context4.stop();
            }
          }
        }, _callee4, null, [[0, 7]]);
      }))();
    },
    loadHistoryItem: function loadHistoryItem(item) {
      try {
        var historyData = JSON.parse(item.data);
        // æ¢å¤AIé€‰æ‹©é…ç½®
        this.aiList = historyData.aiList || this.aiList;
        // æ¢å¤æç¤ºè¯è¾“å…¥
        this.promptInput = historyData.promptInput || item.userPrompt;
        // æ¢å¤ä»»åŠ¡æµç¨‹
        this.enabledAIs = historyData.enabledAIs || [];
        // æ¢å¤ä¸»æœºå¯è§†åŒ–
        this.screenshots = historyData.screenshots || [];
        // æ¢å¤æ‰§è¡Œç»“æœ
        this.results = historyData.results || [];
        // æ¢å¤chatId
        this.chatId = item.chatId || this.chatId;
        this.userInfoReq.toneChatId = item.toneChatId || '';
        this.userInfoReq.ybDsChatId = item.ybDsChatId || '';
        this.userInfoReq.dbChatId = item.dbChatId || '';
        // this.userInfoReq.tyChatId = item.tyChatId || '';

        this.userInfoReq.metasoChatId = item.metasoChatId || "";
        this.userInfoReq.isNewChat = false;

        // ä¸å†æ ¹æ®AIç™»å½•çŠ¶æ€æ›´æ–°AIå¯ç”¨çŠ¶æ€ï¼Œä¿æŒåŸæœ‰é€‰æ‹©

        // å±•å¼€ç›¸å…³åŒºåŸŸ
        this.sectionExpanded.aiConfig = true;
        this.sectionExpanded.promptInput = true;
        this.sectionExpanded.taskStatus = true;
        this.taskStarted = true;
        this.closeHistoryDrawer();
        uni.showToast({
          title: 'å†å²è®°å½•åŠ è½½æˆåŠŸ',
          icon: 'success'
        });
      } catch (error) {
        console.error('åŠ è½½å†å²è®°å½•å¤±è´¥:', error);
        uni.showToast({
          title: 'åŠ è½½å¤±è´¥',
          icon: 'none'
        });
      }
    },
    // åŠ è½½ä¸Šæ¬¡ä¼šè¯
    loadLastChat: function loadLastChat() {
      var _this15 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee5() {
        var res, lastChat;
        return _regenerator.default.wrap(function _callee5$(_context5) {
          while (1) {
            switch (_context5.prev = _context5.next) {
              case 0:
                _context5.prev = 0;
                _context5.next = 3;
                return (0, _aigc.getChatHistory)(_this15.userId, 0);
              case 3:
                res = _context5.sent;
                if (res.code === 200 && res.data && res.data.length > 0) {
                  // è·å–æœ€æ–°çš„ä¼šè¯è®°å½•
                  lastChat = res.data[0];
                  _this15.loadHistoryItem(lastChat);
                }
                _context5.next = 10;
                break;
              case 7:
                _context5.prev = 7;
                _context5.t0 = _context5["catch"](0);
                console.error('åŠ è½½ä¸Šæ¬¡ä¼šè¯å¤±è´¥:', _context5.t0);
              case 10:
              case "end":
                return _context5.stop();
            }
          }
        }, _callee5, null, [[0, 7]]);
      }))();
    },
    saveHistory: function saveHistory() {
      var _this16 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee6() {
        var historyData;
        return _regenerator.default.wrap(function _callee6$(_context6) {
          while (1) {
            switch (_context6.prev = _context6.next) {
              case 0:
                historyData = {
                  aiList: _this16.aiList,
                  promptInput: _this16.promptInput,
                  enabledAIs: _this16.enabledAIs,
                  screenshots: _this16.screenshots,
                  results: _this16.results,
                  chatId: _this16.chatId,
                  toneChatId: _this16.userInfoReq.toneChatId,
                  ybDsChatId: _this16.userInfoReq.ybDsChatId,
                  dbChatId: _this16.userInfoReq.dbChatId,
                  // tyChatId: this.userInfoReq.tyChatId,

                  metasoChatId: _this16.userInfoReq.metasoChatId,
                  baiduChatId: _this16.userInfoReq.baiduChatId,
                  zhzdChatId: _this16.userInfoReq.zhzdChatId
                };
                _context6.prev = 1;
                _context6.next = 4;
                return (0, _aigc.saveUserChatData)({
                  userId: _this16.userId,
                  userPrompt: _this16.promptInput,
                  data: JSON.stringify(historyData),
                  chatId: _this16.chatId,
                  toneChatId: _this16.userInfoReq.toneChatId,
                  ybDsChatId: _this16.userInfoReq.ybDsChatId,
                  dbChatId: _this16.userInfoReq.dbChatId,
                  // tyChatId: this.userInfoReq.tyChatId,

                  metasoChatId: _this16.userInfoReq.metasoChatId,
                  baiduChatId: _this16.userInfoReq.baiduChatId,
                  zhzdChatId: _this16.userInfoReq.zhzdChatId
                });
              case 4:
                _context6.next = 10;
                break;
              case 6:
                _context6.prev = 6;
                _context6.t0 = _context6["catch"](1);
                console.error('ä¿å­˜å†å²è®°å½•å¤±è´¥:', _context6.t0);
                uni.showToast({
                  title: 'ä¿å­˜å†å²è®°å½•å¤±è´¥',
                  icon: 'none'
                });
              case 10:
              case "end":
                return _context6.stop();
            }
          }
        }, _callee6, null, [[1, 6]]);
      }))();
    },
    getHistoryDate: function getHistoryDate(timestamp) {
      try {
        console.log('getHistoryDate è¾“å…¥:', timestamp, (0, _typeof2.default)(timestamp));
        if (!timestamp) {
          return 'æœªçŸ¥æ—¥æœŸ';
        }
        var date;
        if (typeof timestamp === 'number') {
          date = new Date(timestamp);
        } else if (typeof timestamp === 'string') {
          // å¤„ç† "2025-6-23 14:53:12" è¿™ç§æ ¼å¼
          var match = timestamp.match(/(\d{4})-(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{1,2}):(\d{1,2})/);
          if (match) {
            var _match = (0, _slicedToArray2.default)(match, 7),
              year = _match[1],
              month = _match[2],
              day = _match[3],
              hour = _match[4],
              minute = _match[5],
              second = _match[6];
            date = new Date(parseInt(year), parseInt(month) - 1, parseInt(day), parseInt(hour), parseInt(minute), parseInt(second));
          } else {
            // å¦‚æœæ­£åˆ™ä¸åŒ¹é…ï¼Œå°è¯•å…¶ä»–æ–¹å¼
            var fixedTimestamp = timestamp.replace(/\s/g, 'T');
            date = new Date(fixedTimestamp);
            if (isNaN(date.getTime())) {
              date = new Date(timestamp);
            }
          }
        } else {
          date = new Date(timestamp);
        }
        console.log('getHistoryDate è§£æç»“æœ:', date, date.getTime());
        if (isNaN(date.getTime())) {
          return 'æœªçŸ¥æ—¥æœŸ';
        }
        var today = new Date();
        var yesterday = new Date(today);
        yesterday.setDate(yesterday.getDate() - 1);
        if (date.toDateString() === today.toDateString()) {
          return 'ä»Šå¤©';
        } else if (date.toDateString() === yesterday.toDateString()) {
          return 'æ˜¨å¤©';
        } else {
          return date.toLocaleDateString('zh-CN');
        }
      } catch (error) {
        console.error('æ ¼å¼åŒ–æ—¥æœŸé”™è¯¯:', error, timestamp);
        return 'æœªçŸ¥æ—¥æœŸ';
      }
    },
    // æ ¼å¼åŒ–å†å²è®°å½•æ—¶é—´
    formatHistoryTime: function formatHistoryTime(timestamp) {
      try {
        console.log('formatHistoryTime è¾“å…¥:', timestamp, (0, _typeof2.default)(timestamp));
        var date;
        if (!timestamp) {
          return 'æ—¶é—´æœªçŸ¥';
        }

        // å¦‚æœæ˜¯æ•°å­—ï¼Œç›´æ¥åˆ›å»ºDateå¯¹è±¡
        if (typeof timestamp === 'number') {
          date = new Date(timestamp);
        } else if (typeof timestamp === 'string') {
          // å¤„ç†ISO 8601æ ¼å¼ï¼š2025-06-25T07:18:54.110Z
          if (timestamp.includes('T') && (timestamp.includes('Z') || timestamp.includes('+'))) {
            date = new Date(timestamp);
          }
          // å¤„ç† "2025-6-26 08:46:26" è¿™ç§æ ¼å¼
          else {
            var match = timestamp.match(/(\d{4})-(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{1,2}):(\d{1,2})/);
            if (match) {
              var _match2 = (0, _slicedToArray2.default)(match, 7),
                year = _match2[1],
                month = _match2[2],
                day = _match2[3],
                _hour = _match2[4],
                _minute = _match2[5],
                second = _match2[6];
              // æ³¨æ„ï¼šDateæ„é€ å‡½æ•°çš„monthå‚æ•°æ˜¯0-11ï¼Œæ‰€ä»¥è¦å‡1
              date = new Date(parseInt(year), parseInt(month) - 1, parseInt(day), parseInt(_hour), parseInt(_minute), parseInt(second));
            } else {
              // å¦‚æœæ­£åˆ™ä¸åŒ¹é…ï¼Œå°è¯•å…¶ä»–æ–¹å¼
              var fixedTimestamp = timestamp.replace(/\s/g, 'T');
              date = new Date(fixedTimestamp);
              if (isNaN(date.getTime())) {
                date = new Date(timestamp);
              }
            }
          }
        } else if (timestamp instanceof Date) {
          date = timestamp;
        } else {
          date = new Date(timestamp);
        }
        console.log('formatHistoryTime è§£æç»“æœ:', date, date.getTime());
        if (isNaN(date.getTime())) {
          return 'æ—¶é—´æœªçŸ¥';
        }

        // ä½¿ç”¨æ›´ç®€æ´çš„æ—¶é—´æ ¼å¼ï¼Œé¿å…æ˜¾ç¤ºæ—¶åŒºä¿¡æ¯
        var hour = date.getHours().toString().padStart(2, '0');
        var minute = date.getMinutes().toString().padStart(2, '0');
        var timeString = "".concat(hour, ":").concat(minute);
        console.log('formatHistoryTime è¾“å‡º:', timeString);
        return timeString;
      } catch (error) {
        console.error('æ ¼å¼åŒ–æ—¶é—´é”™è¯¯:', error, timestamp);
        return 'æ—¶é—´æœªçŸ¥';
      }
    },
    // ä¿®æ”¹æŠ˜å åˆ‡æ¢æ–¹æ³•
    toggleHistoryExpansion: function toggleHistoryExpansion(item) {
      this.expandedHistoryItems[item.chatId] = !this.expandedHistoryItems[item.chatId];
      this.$forceUpdate(); // å¼ºåˆ¶æ›´æ–°è§†å›¾
    },
    // æ™ºèƒ½è¯„åˆ†ç›¸å…³æ–¹æ³•
    showScoreModal: function showScoreModal() {
      var _this17 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee7() {
        var _require, getAllScorePrompt, response;
        return _regenerator.default.wrap(function _callee7$(_context7) {
          while (1) {
            switch (_context7.prev = _context7.next) {
              case 0:
                _this17.selectedResults = [];
                _this17.scoreModalVisible = true;

                // åŠ è½½è¯„åˆ†æç¤ºè¯æ¨¡æ¿åˆ—è¡¨
                _context7.prev = 2;
                _require = __webpack_require__(/*! @/api/wechat/aigc.js */ 77), getAllScorePrompt = _require.getAllScorePrompt;
                _context7.next = 6;
                return getAllScorePrompt();
              case 6:
                response = _context7.sent;
                if (response.code === 200) {
                  _this17.scorePromptList = response.data || [];
                }
                _context7.next = 13;
                break;
              case 10:
                _context7.prev = 10;
                _context7.t0 = _context7["catch"](2);
                console.error('åŠ è½½è¯„åˆ†æç¤ºè¯æ¨¡æ¿å¤±è´¥:', _context7.t0);
                // å¤±è´¥ä¹Ÿä¸å½±å“ä½¿ç”¨ï¼Œç”¨æˆ·å¯ä»¥æ‰‹åŠ¨è¾“å…¥
              case 13:
              case "end":
                return _context7.stop();
            }
          }
        }, _callee7, null, [[2, 10]]);
      }))();
    },
    closeScoreModal: function closeScoreModal() {
      this.scoreModalVisible = false;
    },
    // è·å–å½“å‰é€‰ä¸­çš„è¯„åˆ†æ¨¡æ¿ç´¢å¼•
    getScorePromptIndex: function getScorePromptIndex() {
      var _this18 = this;
      if (!this.selectedScorePrompt) return 0;
      var index = this.scorePromptList.findIndex(function (prompt) {
        return prompt.name === _this18.selectedScorePrompt;
      });
      return index === -1 ? 0 : index;
    },
    // è¯„åˆ†æ¨¡æ¿é€‰æ‹©å˜åŒ–
    onScorePromptChange: function onScorePromptChange(event) {
      var index = event.detail.value;
      if (this.scorePromptList[index]) {
        this.selectedScorePrompt = this.scorePromptList[index].name;
        this.scorePrompt = this.scorePromptList[index].prompt;
      }
    },
    // åª’ä½“æŠ•é€’ç›¸å…³æ–¹æ³•
    showLayoutModal: function showLayoutModal() {
      if (!this.currentResult) {
        uni.showToast({
          title: 'æ²¡æœ‰å¯æŠ•é€’çš„å†…å®¹',
          icon: 'none'
        });
        return;
      }
      console.log("showLayoutModal", this.currentResult);
      // æ·±åº¦æ‹·è´å½“å‰ç»“æœï¼Œé¿å…å¼•ç”¨è¢«ä¿®æ”¹
      this.currentLayoutResult = {
        aiName: this.currentResult.aiName,
        content: this.currentResult.content,
        shareUrl: this.currentResult.shareUrl,
        shareImgUrl: this.currentResult.shareImgUrl,
        timestamp: this.currentResult.timestamp
      };

      // é»˜è®¤é€‰æ‹©å…¬ä¼—å·
      this.selectedMedia = 'wechat_layout';
      // è®¾ç½®layoutPromptä¸ºå½“å‰ç»“æœå†…å®¹ï¼ˆå‚è€ƒç½‘é¡µç«¯é€»è¾‘ï¼‰
      this.layoutPrompt = this.currentLayoutResult.content;
      this.layoutModalVisible = true;
    },
    // é€‰æ‹©æ’ç‰ˆAI
    selectLayoutAI: function selectLayoutAI(ai) {
      this.layoutAI = ai;
      console.log('é€‰æ‹©æ’ç‰ˆAI:', ai);
    },
    // é€‰æ‹©åª’ä½“
    selectMedia: function selectMedia(media) {
      this.selectedMedia = media;
      console.log('é€‰æ‹©åª’ä½“:', media);
    },
    closeLayoutModal: function closeLayoutModal() {
      this.layoutModalVisible = false;
    },
    handleLayout: function handleLayout() {
      if (!this.currentLayoutResult) return;
      this.closeLayoutModal();

      // æ ¹æ®é€‰æ‹©çš„åª’ä½“åˆ›å»ºæ’ç‰ˆä»»åŠ¡
      if (this.selectedMedia === 'wechat_layout') {
        this.createWechatLayoutTask();
      } else if (this.selectedMedia === 'zhihu_layout') {
        this.createZhihuLayoutTask();
      }
    },
    // åˆ›å»ºçŸ¥ä¹æ’ç‰ˆä»»åŠ¡
    createZhihuLayoutTask: function createZhihuLayoutTask() {
      var _this19 = this;
      // æ„å»ºçŸ¥ä¹æ’ç‰ˆè¯·æ±‚
      var layoutRequest = {
        jsonrpc: '2.0',
        id: this.generateUUID(),
        method: 'AIæ’ç‰ˆ',
        params: {
          taskId: this.generateUUID(),
          userId: this.userId,
          corpId: this.corpId,
          userPrompt: this.currentLayoutResult.content,
          roles: '',
          selectedMedia: 'zhihu_layout'
        }
      };

      // æ ¹æ®é€‰æ‹©çš„AIè®¾ç½®roleså‚æ•°
      var selectedAI = this.aiList.find(function (ai) {
        return ai.name === _this19.layoutAI;
      });
      if (selectedAI) {
        if (selectedAI.name === 'è±†åŒ…') {
          layoutRequest.params.roles = 'zj-db,';
          if (selectedAI.selectedCapabilities.includes('deep_thinking')) {
            layoutRequest.params.roles += 'zj-db-sdsk,';
          }
        } else if (selectedAI.name === 'DeepSeek') {
          layoutRequest.params.roles = 'deepseek,';
          if (selectedAI.selectedCapabilities.includes('deep_thinking')) {
            layoutRequest.params.roles += 'ds-sdsk,';
          }
          if (selectedAI.selectedCapabilities.includes('web_search')) {
            layoutRequest.params.roles += 'ds-lwss,';
          }
        }
      }

      // å‘é€æ’ç‰ˆè¯·æ±‚
      console.log("çŸ¥ä¹æ’ç‰ˆå‚æ•°", layoutRequest);
      this.message(layoutRequest);

      // åˆ›å»ºæ™ºèƒ½æ’ç‰ˆAIèŠ‚ç‚¹
      var znpbAI = {
        name: 'æ™ºèƒ½æ’ç‰ˆ',
        avatar: selectedAI ? selectedAI.avatar : 'https://u3w.com/chatfile/%E8%B1%86%E5%8C%85.png',
        capabilities: [],
        selectedCapabilities: [],
        enabled: true,
        status: 'running',
        progressLogs: [{
          content: 'çŸ¥ä¹æ’ç‰ˆä»»åŠ¡å·²æäº¤ï¼Œæ­£åœ¨æ’ç‰ˆ...',
          timestamp: new Date(),
          isCompleted: false,
          type: 'æ™ºèƒ½æ’ç‰ˆ'
        }],
        isExpanded: true
      };
      this.addOrUpdateTaskAI(znpbAI, 'æ™ºèƒ½æ’ç‰ˆ');
      uni.showToast({
        title: 'çŸ¥ä¹æ’ç‰ˆä»»åŠ¡å·²æäº¤',
        icon: 'success'
      });
    },
    // åˆ›å»ºç™¾å®¶å·æŠ•é€’ä»»åŠ¡
    createBaijiahaoDeliveryTask: function createBaijiahaoDeliveryTask() {
      // ç»„åˆå®Œæ•´çš„æç¤ºè¯ï¼šæ•°æ®åº“æç¤ºè¯ + åŸæ–‡å†…å®¹
      var fullPrompt = this.layoutPrompt + '\n\n' + this.currentLayoutResult.content;

      // æ„å»ºç™¾å®¶å·æŠ•é€’è¯·æ±‚
      var baijiahaoRequest = {
        jsonrpc: '2.0',
        id: this.generateUUID(),
        method: 'æŠ•é€’åˆ°ç™¾å®¶å·',
        params: {
          taskId: this.generateUUID(),
          userId: this.userId,
          corpId: this.corpId,
          userPrompt: fullPrompt,
          aiName: this.currentLayoutResult.aiName,
          content: this.currentLayoutResult.content
        }
      };
      console.log("ç™¾å®¶å·æŠ•é€’å‚æ•°", baijiahaoRequest);
      this.message(baijiahaoRequest);

      // åˆ›å»ºæŠ•é€’åˆ°ç™¾å®¶å·ä»»åŠ¡èŠ‚ç‚¹
      var baijiahaoAI = {
        name: 'æŠ•é€’åˆ°ç™¾å®¶å·',
        avatar: 'https://my-image-hosting.oss-cn-beijing.aliyuncs.com/baojiahao.png',
        capabilities: [],
        selectedCapabilities: [],
        enabled: true,
        status: 'running',
        progressLogs: [{
          content: 'æŠ•é€’åˆ°ç™¾å®¶å·ä»»åŠ¡å·²æäº¤ï¼Œæ­£åœ¨å¤„ç†...',
          timestamp: new Date(),
          isCompleted: false,
          type: 'æŠ•é€’åˆ°ç™¾å®¶å·'
        }],
        isExpanded: true
      };
      this.addOrUpdateTaskAI(baijiahaoAI, 'æŠ•é€’åˆ°ç™¾å®¶å·');
      uni.showToast({
        title: 'ç™¾å®¶å·æŠ•é€’ä»»åŠ¡å·²æäº¤',
        icon: 'success'
      });
    },
    // åˆ›å»ºå¾®å¤´æ¡æ’ç‰ˆä»»åŠ¡
    createToutiaoLayoutTask: function createToutiaoLayoutTask() {
      // ç»„åˆå®Œæ•´çš„æç¤ºè¯ï¼šæ•°æ®åº“æç¤ºè¯ + åŸæ–‡å†…å®¹
      var fullPrompt = this.layoutPrompt + '\n\n' + this.currentLayoutResult.content;

      // æ„å»ºå¾®å¤´æ¡æ’ç‰ˆè¯·æ±‚
      var layoutRequest = {
        jsonrpc: '2.0',
        id: this.generateUUID(),
        method: 'å¾®å¤´æ¡æ’ç‰ˆ',
        params: {
          taskId: this.generateUUID(),
          userId: this.userId,
          corpId: this.corpId,
          userPrompt: fullPrompt,
          roles: ''
        }
      };
      console.log("å¾®å¤´æ¡æ’ç‰ˆå‚æ•°", layoutRequest);
      this.message(layoutRequest);

      // åˆ›å»ºå¾®å¤´æ¡æ’ç‰ˆAIèŠ‚ç‚¹
      var tthZnpbAI = {
        name: 'å¾®å¤´æ¡æ’ç‰ˆ',
        avatar: 'https://u3w.com/chatfile/TouTiao.png',
        capabilities: [],
        selectedCapabilities: [],
        enabled: true,
        status: 'running',
        progressLogs: [{
          content: 'å¾®å¤´æ¡æ’ç‰ˆä»»åŠ¡å·²æäº¤ï¼Œæ­£åœ¨æ’ç‰ˆ...',
          timestamp: new Date(),
          isCompleted: false,
          type: 'å¾®å¤´æ¡æ’ç‰ˆ'
        }],
        isExpanded: true
      };
      this.addOrUpdateTaskAI(tthZnpbAI, 'å¾®å¤´æ¡æ’ç‰ˆ');
      uni.showToast({
        title: 'å¾®å¤´æ¡æ’ç‰ˆä»»åŠ¡å·²æäº¤',
        icon: 'success'
      });
    },
    // åˆ›å»ºå…¬ä¼—å·æ’ç‰ˆä»»åŠ¡ï¼ˆå‚è€ƒwebç«¯å®ç°ï¼‰
    createWechatLayoutTask: function createWechatLayoutTask() {
      var _this20 = this;
      // æ„å»ºæ™ºèƒ½æ’ç‰ˆè¯·æ±‚
      var layoutRequest = {
        jsonrpc: '2.0',
        id: this.generateUUID(),
        method: 'AIæ’ç‰ˆ',
        params: {
          taskId: this.generateUUID(),
          userId: this.userId,
          corpId: this.corpId,
          userPrompt: this.currentLayoutResult.content,
          roles: '',
          selectedMedia: 'wechat_layout'
        }
      };

      // æ ¹æ®é€‰æ‹©çš„AIè®¾ç½®rolesï¼ˆå‚è€ƒwebç«¯é€»è¾‘ï¼‰
      var selectedAI = this.aiList.find(function (ai) {
        return ai.name === _this20.layoutAI;
      });
      if (selectedAI) {
        if (selectedAI.name === 'è±†åŒ…') {
          layoutRequest.params.roles = 'zj-db,';
          if (selectedAI.selectedCapabilities.includes('deep_thinking')) {
            layoutRequest.params.roles += 'zj-db-sdsk,';
          }
        } else if (selectedAI.name === 'DeepSeek') {
          layoutRequest.params.roles = 'deepseek,';
          if (selectedAI.selectedCapabilities.includes('deep_thinking')) {
            layoutRequest.params.roles += 'ds-sdsk,';
          }
          if (selectedAI.selectedCapabilities.includes('web_search')) {
            layoutRequest.params.roles += 'ds-lwss,';
          }
        }
      }

      // å‘é€æ’ç‰ˆè¯·æ±‚
      console.log("å…¬ä¼—å·æ’ç‰ˆå‚æ•°", layoutRequest);
      this.message(layoutRequest);

      // åˆ›å»ºæ™ºèƒ½æ’ç‰ˆAIèŠ‚ç‚¹
      var znpbAI = {
        name: 'æ™ºèƒ½æ’ç‰ˆ',
        avatar: selectedAI ? selectedAI.avatar : 'https://u3w.com/chatfile/%E8%B1%86%E5%8C%85.png',
        capabilities: [],
        selectedCapabilities: [],
        enabled: true,
        status: 'running',
        progressLogs: [{
          content: 'å…¬ä¼—å·æ’ç‰ˆä»»åŠ¡å·²æäº¤ï¼Œæ­£åœ¨æ’ç‰ˆ...',
          timestamp: new Date(),
          isCompleted: false,
          type: 'æ™ºèƒ½æ’ç‰ˆ'
        }],
        isExpanded: true
      };
      this.addOrUpdateTaskAI(znpbAI, 'æ™ºèƒ½æ’ç‰ˆ');
      uni.showToast({
        title: 'å…¬ä¼—å·æ’ç‰ˆè¯·æ±‚å·²å‘é€ï¼Œè¯·ç­‰å¾…ç»“æœ',
        icon: 'success'
      });
    },
    // æ·»åŠ æˆ–æ›´æ–°ä»»åŠ¡AI
    addOrUpdateTaskAI: function addOrUpdateTaskAI(aiNode, taskName) {
      var existIndex = this.enabledAIs.findIndex(function (ai) {
        return ai.name === taskName;
      });
      if (existIndex === -1) {
        // å¦‚æœä¸å­˜åœ¨ï¼Œæ·»åŠ åˆ°æ•°ç»„å¼€å¤´
        this.enabledAIs.unshift(aiNode);
      } else {
        // å¦‚æœå·²å­˜åœ¨ï¼Œå…ˆç§»é™¤æ—§çš„ï¼Œå†å°†æ–°çš„æ·»åŠ åˆ°å¼€å¤´
        this.enabledAIs.splice(existIndex, 1);
        this.enabledAIs.unshift(aiNode);
      }
      this.$forceUpdate();
    },
    // ç›´æ¥æŠ•é€’å·²æ’ç‰ˆçš„å†…å®¹åˆ°å…¬ä¼—å·
    handleDirectPushToWechat: function handleDirectPushToWechat(result) {
      var _this21 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee8() {
        var mediaLabel, mediaItem, mediaName, params, res, mediaRequest, mediaDeliveryAI;
        return _regenerator.default.wrap(function _callee8$(_context8) {
          while (1) {
            switch (_context8.prev = _context8.next) {
              case 0:
                _context8.prev = 0;
                console.log("handleDirectPushToWechat å¼€å§‹æ‰§è¡Œ", result);

                // éªŒè¯å†…å®¹æ˜¯å¦ä¸ºç©º
                if (!(!result.content || result.content.trim() === '')) {
                  _context8.next = 5;
                  break;
                }
                uni.showToast({
                  title: 'æŠ•é€’å†…å®¹ä¸ºç©ºï¼Œè¯·å…ˆè¿›è¡ŒAIæ’ç‰ˆç”Ÿæˆå†…å®¹',
                  icon: 'none'
                });
                return _context8.abrupt("return");
              case 5:
                // æå–åª’ä½“ç±»å‹ï¼šä» aiName ä¸­å»æ‰ "æ™ºèƒ½æ’ç‰ˆ" å››ä¸ªå­—
                mediaLabel = result.aiName.substring(4); // å»æ‰"æ™ºèƒ½æ’ç‰ˆ"
                mediaItem = _this21.mediaList.find(function (media) {
                  return media.label === mediaLabel;
                });
                mediaName = mediaItem ? mediaItem.name : '';
                console.log("æå–çš„åª’ä½“ç±»å‹:", mediaLabel, mediaName);

                // æ ¹æ®åª’ä½“ç±»å‹è¿›è¡Œä¸åŒçš„å¤„ç†
                if (!mediaName.includes('wechat')) {
                  _context8.next = 21;
                  break;
                }
                // å…¬ä¼—å·æŠ•é€’ï¼šç›´æ¥è°ƒç”¨API
                uni.showLoading({
                  title: 'æ­£åœ¨æŠ•é€’åˆ°å…¬ä¼—å·...'
                });
                _this21.collectNum++;
                params = {
                  contentText: result.content,
                  userId: _this21.userId,
                  shareUrl: result.shareUrl || '',
                  aiName: result.aiName || '',
                  num: _this21.collectNum
                };
                console.log("å…¬ä¼—å·æŠ•é€’å‚æ•°", params);
                _context8.next = 16;
                return (0, _aigc.pushAutoOffice)(params);
              case 16:
                res = _context8.sent;
                uni.hideLoading();
                if (res.code === 200) {
                  uni.showToast({
                    title: 'æŠ•é€’åˆ°å…¬ä¼—å·æˆåŠŸ',
                    icon: 'success'
                  });
                } else {
                  uni.showToast({
                    title: res.message || 'æŠ•é€’å¤±è´¥',
                    icon: 'none'
                  });
                }
                _context8.next = 22;
                break;
              case 21:
                if (mediaName.includes('zhihu')) {
                  // çŸ¥ä¹æŠ•é€’ï¼šé€šè¿‡WebSocketå‘é€æŠ•é€’è¯·æ±‚
                  uni.showLoading({
                    title: 'æ­£åœ¨æŠ•é€’åˆ°çŸ¥ä¹...'
                  });
                  mediaRequest = {
                    jsonrpc: "2.0",
                    id: _this21.generateUUID(),
                    method: "åª’ä½“æŠ•é€’",
                    params: {
                      taskId: _this21.generateUUID(),
                      userId: _this21.userId,
                      corpId: _this21.corpId,
                      aiName: result.aiName,
                      userPrompt: result.content,
                      selectedMedia: "zhihu_layout"
                    }
                  };
                  console.log("çŸ¥ä¹æŠ•é€’å‚æ•°", mediaRequest);
                  _this21.message(mediaRequest);

                  // åˆ›å»ºåª’ä½“æŠ•é€’ä»»åŠ¡èŠ‚ç‚¹
                  mediaDeliveryAI = {
                    name: 'åª’ä½“æŠ•é€’',
                    avatar: 'https://u3w.com/chatfile/%E8%B1%86%E5%8C%85.png',
                    capabilities: [],
                    selectedCapabilities: [],
                    enabled: true,
                    status: 'running',
                    progressLogs: [{
                      content: 'çŸ¥ä¹æŠ•é€’ä»»åŠ¡å·²æäº¤ï¼Œæ­£åœ¨æŠ•é€’...',
                      timestamp: new Date(),
                      isCompleted: false,
                      type: 'åª’ä½“æŠ•é€’'
                    }],
                    isExpanded: true
                  }; // æ·»åŠ æˆ–æ›´æ–°åª’ä½“æŠ•é€’ä»»åŠ¡
                  _this21.addOrUpdateTaskAI(mediaDeliveryAI, 'åª’ä½“æŠ•é€’');
                  uni.hideLoading();
                  uni.showToast({
                    title: 'åª’ä½“æŠ•é€’è¯·æ±‚å·²å‘é€ï¼Œè¯·ç­‰å¾…ç»“æœ',
                    icon: 'success'
                  });
                } else {
                  uni.showToast({
                    title: 'ä¸æ”¯æŒçš„åª’ä½“ç±»å‹',
                    icon: 'none'
                  });
                }
              case 22:
                _context8.next = 29;
                break;
              case 24:
                _context8.prev = 24;
                _context8.t0 = _context8["catch"](0);
                uni.hideLoading();
                console.error('æŠ•é€’å¤±è´¥:', _context8.t0);
                uni.showToast({
                  title: 'æŠ•é€’å¤±è´¥',
                  icon: 'none'
                });
              case 29:
              case "end":
                return _context8.stop();
            }
          }
        }, _callee8, null, [[0, 24]]);
      }))();
    },
    // æ¨é€åˆ°å…¬ä¼—å·
    handlePushToWechat: function handlePushToWechat(contentText) {
      var _this22 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee9() {
        var params, res;
        return _regenerator.default.wrap(function _callee9$(_context9) {
          while (1) {
            switch (_context9.prev = _context9.next) {
              case 0:
                _context9.prev = 0;
                console.log("handlePushToWechat å¼€å§‹æ‰§è¡Œ", _this22.currentLayoutResult);
                if (_this22.currentLayoutResult) {
                  _context9.next = 6;
                  break;
                }
                console.error("currentLayoutResult ä¸ºç©ºï¼Œæ— æ³•æŠ•é€’");
                uni.showToast({
                  title: 'æŠ•é€’å¤±è´¥ï¼šç¼ºå°‘åŸå§‹ç»“æœä¿¡æ¯',
                  icon: 'none'
                });
                return _context9.abrupt("return");
              case 6:
                uni.showLoading({
                  title: 'æ­£åœ¨æŠ•é€’...'
                });

                // è‡ªå¢è®¡æ•°å™¨
                _this22.collectNum++;
                params = {
                  contentText: contentText,
                  userId: _this22.userId,
                  shareUrl: _this22.currentLayoutResult.shareUrl || '',
                  aiName: _this22.currentLayoutResult.aiName || '',
                  num: _this22.collectNum
                };
                console.log("æŠ•é€’å‚æ•°", params);
                _context9.next = 12;
                return (0, _aigc.pushAutoOffice)(params);
              case 12:
                res = _context9.sent;
                uni.hideLoading();
                if (res.code === 200) {
                  uni.showToast({
                    title: 'æŠ•é€’æˆåŠŸ',
                    icon: 'success'
                  });
                } else {
                  uni.showToast({
                    title: res.message || 'æŠ•é€’å¤±è´¥',
                    icon: 'none'
                  });
                }
                _context9.next = 22;
                break;
              case 17:
                _context9.prev = 17;
                _context9.t0 = _context9["catch"](0);
                uni.hideLoading();
                console.error('æŠ•é€’åˆ°å…¬ä¼—å·å¤±è´¥:', _context9.t0);
                uni.showToast({
                  title: 'æŠ•é€’å¤±è´¥',
                  icon: 'none'
                });
              case 22:
              case "end":
                return _context9.stop();
            }
          }
        }, _callee9, null, [[0, 17]]);
      }))();
    },
    toggleResultSelection: function toggleResultSelection(event) {
      var values = event.detail.value;
      console.log('toggleResultSelection - é€‰ä¸­çš„values:', values);
      console.log('toggleResultSelection - å½“å‰scorePrompt:', this.scorePrompt.trim());
      this.selectedResults = values;
      console.log('toggleResultSelection - æ›´æ–°åçš„selectedResults:', this.selectedResults);
      console.log('toggleResultSelection - canScoreçŠ¶æ€:', this.canScore);
    },
    handleScore: function handleScore() {
      var _this23 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee10() {
        var _require2, _getScoreWord, response, scoreSuffix, selectedContents, fullPrompt, scoreRequest, selectedAI, wkpfAI;
        return _regenerator.default.wrap(function _callee10$(_context10) {
          while (1) {
            switch (_context10.prev = _context10.next) {
              case 0:
                if (_this23.canScore) {
                  _context10.next = 2;
                  break;
                }
                return _context10.abrupt("return");
              case 2:
                _context10.prev = 2;
                // è°ƒç”¨getScoreWord APIè·å–è¯„åˆ†åç¼€
                _require2 = __webpack_require__(/*! @/api/wechat/aigc.js */ 77), _getScoreWord = _require2.getScoreWord;
                _context10.next = 6;
                return _getScoreWord();
              case 6:
                response = _context10.sent;
                scoreSuffix = response.code === 200 ? response.data : 'åˆç¨¿ï¼š'; // è·å–é€‰ä¸­çš„ç»“æœå†…å®¹å¹¶æŒ‰ç…§æŒ‡å®šæ ¼å¼æ‹¼æ¥
                selectedContents = _this23.results.filter(function (result) {
                  return _this23.selectedResults.includes(result.aiName);
                }).map(function (result) {
                  // å°†HTMLå†…å®¹è½¬æ¢ä¸ºçº¯æ–‡æœ¬ï¼ˆå°ç¨‹åºç‰ˆæœ¬ç®€åŒ–å¤„ç†ï¼‰
                  var plainContent = result.content.replace(/<[^>]*>/g, '');
                  return "".concat(result.aiName).concat(scoreSuffix).concat(plainContent, "\n");
                }).join('\n'); // æ„å»ºå®Œæ•´çš„è¯„åˆ†æç¤ºå†…å®¹
                fullPrompt = "".concat(_this23.scorePrompt, "\n").concat(selectedContents); // æ„å»ºè¯„åˆ†è¯·æ±‚
                scoreRequest = {
                  jsonrpc: '2.0',
                  id: _this23.generateUUID(),
                  method: 'AIè¯„åˆ†',
                  params: {
                    taskId: _this23.generateUUID(),
                    userId: _this23.userId,
                    corpId: _this23.corpId,
                    userPrompt: fullPrompt,
                    roles: ''
                  }
                }; // æ ¹æ®é€‰æ‹©çš„AIè®¾ç½®roleså‚æ•°
                selectedAI = _this23.aiList.find(function (ai) {
                  return ai.name === _this23.scoreAI;
                });
                if (selectedAI) {
                  if (selectedAI.name === 'è±†åŒ…') {
                    scoreRequest.params.roles = 'zj-db,';
                    if (selectedAI.selectedCapabilities.includes('deep_thinking')) {
                      scoreRequest.params.roles += 'zj-db-sdsk,';
                    }
                  } else if (selectedAI.name === 'DeepSeek') {
                    scoreRequest.params.roles = 'deepseek,';
                    if (selectedAI.selectedCapabilities.includes('deep_thinking')) {
                      scoreRequest.params.roles += 'ds-sdsk,';
                    }
                    if (selectedAI.selectedCapabilities.includes('web_search')) {
                      scoreRequest.params.roles += 'ds-lwss,';
                    }
                  }
                }

                // å‘é€è¯„åˆ†è¯·æ±‚
                console.log("è¯„åˆ†å‚æ•°", scoreRequest);
                _this23.message(scoreRequest);
                _this23.closeScoreModal();

                // åˆ›å»ºæ™ºèƒ½è¯„åˆ†AIèŠ‚ç‚¹
                wkpfAI = {
                  name: 'æ™ºèƒ½è¯„åˆ†',
                  avatar: selectedAI ? selectedAI.avatar : 'https://u3w.com/chatfile/%E8%B1%86%E5%8C%85.png',
                  capabilities: [],
                  selectedCapabilities: [],
                  enabled: true,
                  status: 'running',
                  progressLogs: [{
                    content: 'æ™ºèƒ½è¯„åˆ†ä»»åŠ¡å·²æäº¤ï¼Œæ­£åœ¨è¯„åˆ†...',
                    timestamp: new Date(),
                    isCompleted: false,
                    type: 'æ™ºèƒ½è¯„åˆ†'
                  }],
                  isExpanded: true
                }; // æ·»åŠ æˆ–æ›´æ–°æ™ºèƒ½è¯„åˆ†ä»»åŠ¡
                _this23.addOrUpdateTaskAI(wkpfAI, 'æ™ºèƒ½è¯„åˆ†');
                uni.showToast({
                  title: 'è¯„åˆ†è¯·æ±‚å·²å‘é€ï¼Œè¯·ç­‰å¾…ç»“æœ',
                  icon: 'success'
                });
                _context10.next = 25;
                break;
              case 21:
                _context10.prev = 21;
                _context10.t0 = _context10["catch"](2);
                console.error('æ™ºèƒ½è¯„åˆ†å¤±è´¥:', _context10.t0);
                uni.showToast({
                  title: 'è¯„åˆ†è¯·æ±‚å¤±è´¥',
                  icon: 'none'
                });
              case 25:
              case "end":
                return _context10.stop();
            }
          }
        }, _callee10, null, [[2, 21]]);
      }))();
    },
    // é€‰æ‹©è¯„åˆ†AI
    selectScoreAI: function selectScoreAI(ai) {
      this.scoreAI = ai;
      console.log('é€‰æ‹©è¯„åˆ†AI:', ai);
    },
    // åˆ›å»ºæ–°å¯¹è¯
    createNewChat: function createNewChat() {
      // é‡ç½®æ‰€æœ‰æ•°æ®
      this.chatId = this.generateUUID();
      this.promptInput = '';
      this.taskStarted = false;
      this.screenshots = [];
      this.results = [];
      this.enabledAIs = [];
      this.userInfoReq = {
        userPrompt: '',
        userId: this.userId,
        corpId: this.corpId,
        taskId: '',
        roles: '',
        toneChatId: '',
        ybDsChatId: '',
        dbChatId: '',
        tyChatId: '',
        metasoChatId: '',
        baiduChatId: '',
        zhzdChatId: '',
        isNewChat: true
      };
      // é‡ç½®AIåˆ—è¡¨ä¸ºåˆå§‹çŠ¶æ€
      this.aiList = [{
        name: 'DeepSeek',
        avatar: 'https://u3w.com/chatfile/Deepseek.png',
        capabilities: [{
          label: 'æ·±åº¦æ€è€ƒ',
          value: 'deep_thinking'
        }, {
          label: 'è”ç½‘æœç´¢',
          value: 'web_search'
        }],
        selectedCapabilities: ['deep_thinking', 'web_search'],
        enabled: true,
        status: 'idle',
        progressLogs: [],
        isExpanded: true,
        isSingleSelect: false // æ·»åŠ å•é€‰æ ‡è®°
      }, {
        name: 'è±†åŒ…',
        avatar: 'https://u3w.com/chatfile/%E8%B1%86%E5%8C%85.png',
        capabilities: [{
          label: 'æ·±åº¦æ€è€ƒ',
          value: 'deep_thinking'
        }],
        selectedCapabilities: ['deep_thinking'],
        enabled: true,
        status: 'idle',
        progressLogs: [],
        isExpanded: true,
        isSingleSelect: false // æ·»åŠ å•é€‰æ ‡è®°
      }, {
        name: 'é€šä¹‰åƒé—®',
        avatar: 'https://u3w.com/chatfile/TongYi.png',
        capabilities: [{
          label: 'æ·±åº¦æ€è€ƒ',
          value: 'deep_thinking'
        }, {
          label: 'è”ç½‘æœç´¢',
          value: 'web_search'
        }],
        selectedCapability: '',
        enabled: true,
        status: 'idle',
        progressLogs: [],
        isExpanded: true
      }, {
        name: 'ç§˜å¡”',
        avatar: 'https://www.aitool6.com/wp-content/uploads/2023/06/9557d1-2.jpg',
        capabilities: [{
          label: 'æé€Ÿ',
          value: 'fast'
        }, {
          label: 'æé€Ÿæ€è€ƒ',
          value: 'fast_thinking'
        }, {
          label: 'é•¿æ€è€ƒ',
          value: 'long_thinking'
        }],
        selectedCapabilities: "fast",
        enabled: true,
        status: 'idle',
        progressLogs: [],
        isExpanded: true,
        isSingleSelect: true // æ·»åŠ å•é€‰æ ‡è®°
      }, {
        name: "çŸ¥ä¹ç›´ç­”",
        avatar: 'https://u3w.com/chatfile/ZHZD.png',
        capabilities: [{
          label: "æ™ºèƒ½æ€è€ƒ",
          value: "smart_thinking"
        }, {
          label: "æ·±åº¦æ€è€ƒ",
          value: "deep_thinking"
        }, {
          label: "å¿«é€Ÿå›ç­”",
          value: "fast_answer"
        }],
        selectedCapability: "smart_thinking",
        // æ”¹ä¸ºå•é€‰ï¼Œé»˜è®¤æ™ºèƒ½æ€è€ƒ
        enabled: true,
        status: 'idle',
        progressLogs: [],
        isExpanded: true,
        isSingleSelect: true // è®¾ä¸ºå•é€‰æ¨¡å¼
      }, {
        name: "ç™¾åº¦AI",
        avatar: 'https://u3w.com/chatfile/baiduAI.png',
        capabilities: [{
          label: "æ·±åº¦æœç´¢",
          value: "web_search"
        }],
        selectedCapabilities: [],
        enabled: true,
        status: "idle",
        progressLogs: [],
        isExpanded: true
      }, {
        name: 'è…¾è®¯å…ƒå®',
        avatar: 'https://u3w.com/chatfile/yuanbao.png',
        capabilities: [{
          label: 'æ·±åº¦æ€è€ƒ',
          value: 'deep_thinking'
        }, {
          label: 'è”ç½‘æœç´¢',
          value: 'web_search'
        }],
        selectedCapabilities: ['deep_thinking', 'web_search'],
        selectedModel: 'hunyuan',
        // é»˜è®¤é€‰æ‹©æ··å…ƒ
        models: [{
          label: 'æ··å…ƒ',
          value: 'hunyuan'
        }, {
          label: 'DeepSeek',
          value: 'deepseek'
        }],
        enabled: true,
        status: 'idle',
        progressLogs: [],
        isExpanded: true,
        isSingleSelect: false
      }];
      // ä¸å†æ ¹æ®AIç™»å½•çŠ¶æ€æ›´æ–°AIå¯ç”¨çŠ¶æ€ï¼Œä¿æŒåŸæœ‰é€‰æ‹©

      // å±•å¼€ç›¸å…³åŒºåŸŸ
      this.sectionExpanded.aiConfig = true;
      this.sectionExpanded.promptInput = true;
      this.sectionExpanded.taskStatus = true;
      uni.showToast({
        title: 'å·²åˆ›å»ºæ–°å¯¹è¯',
        icon: 'success'
      });
    },
    // AIçŠ¶æ€ç›¸å…³æ–¹æ³•
    checkAiLoginStatus: function checkAiLoginStatus() {
      var _this24 = this;
      // å»¶è¿Ÿæ£€æŸ¥ï¼Œç¡®ä¿WebSocketè¿æ¥å·²å»ºç«‹
      setTimeout(function () {
        _this24.sendAiStatusCheck();
        // ä¸å†æ›´æ–°AIå¯ç”¨çŠ¶æ€ï¼Œä¿æŒåŸæœ‰é€‰æ‹©
      }, 2000);
    },
    sendAiStatusCheck: function sendAiStatusCheck() {
      // æ£€æŸ¥è…¾è®¯å…ƒå®ç™»å½•çŠ¶æ€
      this.sendWebSocketMessage({
        type: 'PLAY_CHECK_YB_LOGIN',
        userId: this.userId,
        corpId: this.corpId
      });

      // æ£€æŸ¥è±†åŒ…ç™»å½•çŠ¶æ€
      this.sendWebSocketMessage({
        type: 'PLAY_CHECK_DB_LOGIN',
        userId: this.userId,
        corpId: this.corpId
      });

      // æ£€æŸ¥DeepSeekç™»å½•çŠ¶æ€
      this.sendWebSocketMessage({
        type: 'PLAY_CHECK_DEEPSEEK_LOGIN',
        userId: this.userId,
        corpId: this.corpId
      });

      // æ£€æŸ¥é€šä¹‰åƒé—®ç™»å½•çŠ¶æ€
      this.sendWebSocketMessage({
        type: 'PLAY_CHECK_QW_LOGIN',
        userId: this.userId,
        corpId: this.corpId
      });

      // æ£€æŸ¥ç§˜å¡”ç™»å½•çŠ¶æ€
      this.sendWebSocketMessage({
        type: "PLAY_CHECK_METASO_LOGIN",
        userId: this.userId,
        corpId: this.corpId
      });

      // æ£€æŸ¥ç™¾åº¦AIç™»å½•çŠ¶æ€
      this.sendWebSocketMessage({
        type: 'PLAY_CHECK_BAIDU_LOGIN',
        userId: this.userId,
        corpId: this.corpId
      });

      // æ£€æŸ¥çŸ¥ä¹ç›´ç­”ç™»å½•çŠ¶æ€
      console.log('å‘é€çŸ¥ä¹ç›´ç­”ç™»å½•æ£€éªŒè¯·æ±‚:', {
        type: 'PLAY_CHECK_ZHZD_LOGIN',
        userId: this.userId,
        corpId: this.corpId
      });
      this.sendWebSocketMessage({
        type: 'PLAY_CHECK_ZHZD_LOGIN',
        userId: this.userId,
        corpId: this.corpId
      });
    },
    getPlatformIcon: function getPlatformIcon(type) {
      var icons = {
        yuanbao: 'https://u3w.com/chatfile/yuanbao.png',
        doubao: 'https://u3w.com/chatfile/%E8%B1%86%E5%8C%85.png',
        agent: 'https://u3w.com/chatfile/yuanbao.png',
        tongyi: 'https://u3w.com/chatfile/TongYi.png'
      };
      return icons[type] || '';
    },
    getPlatformName: function getPlatformName(type) {
      var names = {
        yuanbao: 'è…¾è®¯å…ƒå®',
        doubao: 'è±†åŒ…',
        agent: 'æ™ºèƒ½ä½“'
        // tongyi: 'é€šä¹‰åƒé—®',
      };

      return names[type] || '';
    },
    refreshAiStatus: function refreshAiStatus() {
      var _this25 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee11() {
        var result;
        return _regenerator.default.wrap(function _callee11$(_context11) {
          while (1) {
            switch (_context11.prev = _context11.next) {
              case 0:
                if (!_this25.isRefreshing) {
                  _context11.next = 3;
                  break;
                }
                console.log('æ­£åœ¨åˆ·æ–°ä¸­ï¼Œè·³è¿‡é‡å¤æ“ä½œ');
                return _context11.abrupt("return");
              case 3:
                _this25.isRefreshing = true;
                _context11.prev = 4;
                _context11.prev = 5;
                _context11.next = 8;
                return (0, _corpId.ensureLatestCorpId)();
              case 8:
                result = _context11.sent;
                console.log('åˆ·æ–°æŒ‰é’®ï¼šä¸»æœºIDå·²æ›´æ–°ä¸ºæœ€æ–°å€¼:', result.corpId);
                if (result.corpId !== _this25.corpId) {
                  console.log('æ£€æµ‹åˆ°ä¸»æœºIDå˜æ›´ï¼Œä»', _this25.corpId, 'æ›´æ–°ä¸º', result.corpId);
                  _this25.corpId = result.corpId;
                  _this25.userInfoReq.corpId = result.corpId;
                  // æ›´æ–°æœ¬åœ°å­˜å‚¨ï¼Œç¡®ä¿ä¸€è‡´æ€§
                  _storage.default.set(_constant.default.corpId, result.corpId);
                  console.log('æœ¬åœ°ä¸»æœºIDå­˜å‚¨å·²åŒæ­¥:', result.corpId);
                } else {
                  console.log('ä¸»æœºIDæ— å˜åŒ–ï¼Œå½“å‰å€¼:', _this25.corpId);
                }
                _context11.next = 16;
                break;
              case 13:
                _context11.prev = 13;
                _context11.t0 = _context11["catch"](5);
                console.error('ç¡®ä¿ä¼ä¸šIDæœ€æ–°å¤±è´¥:', _context11.t0);
              case 16:
                // é‡ç½®æ‰€æœ‰AIçŠ¶æ€ä¸ºåŠ è½½ä¸­
                _this25.isLoading = {
                  yuanbao: true,
                  doubao: true,
                  deepseek: true,
                  tongyi: true,
                  metaso: true,
                  baidu: true,
                  zhzd: true
                };

                // é‡ç½®ç™»å½•çŠ¶æ€
                _this25.aiLoginStatus = {
                  yuanbao: false,
                  doubao: false,
                  deepseek: false,
                  tongyi: false,
                  metaso: false,
                  baidu: false,
                  zhzd: false
                };

                // é‡ç½®è´¦æˆ·ä¿¡æ¯
                _this25.accounts = {
                  yuanbao: '',
                  doubao: '',
                  deepseek: '',
                  tongyi: '',
                  metaso: '',
                  baidu: '',
                  zhzd: ''
                };

                // æ˜¾ç¤ºåˆ·æ–°æç¤º
                uni.showToast({
                  title: 'æ­£åœ¨åˆ·æ–°è¿æ¥çŠ¶æ€...',
                  icon: 'loading',
                  duration: 1500
                });

                // é‡æ–°å»ºç«‹WebSocketè¿æ¥ï¼Œä½¿ç”¨æœ€æ–°çš„ä¸»æœºID
                console.log('å‡†å¤‡é‡æ–°å»ºç«‹WebSocketè¿æ¥ï¼Œä½¿ç”¨ä¸»æœºID:', _this25.corpId);
                _this25.closeWebSocket();
                setTimeout(function () {
                  console.log('å¼€å§‹åˆå§‹åŒ–WebSocketï¼Œä¸»æœºID:', _this25.corpId);
                  _this25.initWebSocket();
                  // å»¶è¿Ÿæ£€æŸ¥AIçŠ¶æ€ï¼Œç¡®ä¿WebSocketé‡æ–°è¿æ¥
                  setTimeout(function () {
                    console.log('å‘é€AIçŠ¶æ€æ£€æŸ¥ï¼Œä¸»æœºID:', _this25.corpId);
                    _this25.sendAiStatusCheck();
                    // é‡ç½®åˆ·æ–°æ ‡å¿—
                    _this25.isRefreshing = false;
                  }, 2000);
                }, 500);
                _context11.next = 30;
                break;
              case 25:
                _context11.prev = 25;
                _context11.t1 = _context11["catch"](4);
                console.error('åˆ·æ–°AIçŠ¶æ€æ—¶å‘ç”Ÿé”™è¯¯:', _context11.t1);
                _this25.isRefreshing = false;
                uni.showToast({
                  title: 'åˆ·æ–°å¤±è´¥ï¼Œè¯·é‡è¯•',
                  icon: 'none'
                });
              case 30:
              case "end":
                return _context11.stop();
            }
          }
        }, _callee11, null, [[4, 25], [5, 13]]);
      }))();
    },
    // åˆ¤æ–­AIæ˜¯å¦å·²ç™»å½•å¯ç”¨
    isAiLoginEnabled: function isAiLoginEnabled(ai) {
      switch (ai.name) {
        case 'è…¾è®¯å…ƒå®':
          return this.aiLoginStatus.yuanbao;
        // è…¾è®¯å…ƒå®ç™»å½•çŠ¶æ€
        case 'è±†åŒ…':
          return this.aiLoginStatus.doubao;
        // è±†åŒ…ç™»å½•çŠ¶æ€
        case 'DeepSeek':
          return this.aiLoginStatus.deepseek;
        // ä½¿ç”¨å®é™…çš„DeepSeekç™»å½•çŠ¶æ€
        case 'é€šä¹‰åƒé—®':
          return this.aiLoginStatus.tongyi;
        // é€šä¹‰ç™»å½•çŠ¶æ€
        case "ç§˜å¡”":
          return this.aiLoginStatus.metaso;
        // ç§˜å¡”ç™»å½•çŠ¶æ€
        case "çŸ¥ä¹ç›´ç­”":
          return this.aiLoginStatus.zhzd;
        // çŸ¥ä¹ç›´ç­”ç™»å½•çŠ¶æ€
        case "ç™¾åº¦AI":
          return this.aiLoginStatus.baidu;
        // ç™¾åº¦AIç™»å½•çŠ¶æ€

        default:
          return false;
      }
    },
    // åˆ¤æ–­AIæ˜¯å¦åœ¨åŠ è½½çŠ¶æ€
    isAiInLoading: function isAiInLoading(ai) {
      switch (ai.name) {
        case 'è…¾è®¯å…ƒå®':
          return this.isLoading.yuanbao;
        case 'è±†åŒ…':
          return this.isLoading.doubao;
        case 'DeepSeek':
          return this.isLoading.deepseek;
        // ä½¿ç”¨å®é™…çš„DeepSeekåŠ è½½çŠ¶æ€
        case 'é€šä¹‰åƒé—®':
          return this.isLoading.tongyi;
        case "ç§˜å¡”":
          return this.isLoading.metaso;
        case "çŸ¥ä¹ç›´ç­”":
          return this.isLoading.zhzd;
        case "ç™¾åº¦AI":
          return this.isLoading.baidu;
        default:
          return false;
      }
    },
    // æ ¹æ®ç™»å½•çŠ¶æ€ç¦ç”¨ç›¸å…³AIï¼ˆå·²åºŸå¼ƒï¼Œä¸å†ä¿®æ”¹enabledçŠ¶æ€ï¼‰
    disableAIsByLoginStatus: function disableAIsByLoginStatus(loginType) {
      // ä¸å†ä¿®æ”¹enabledçŠ¶æ€ï¼Œåªé€šè¿‡UIæ§åˆ¶æ“ä½œæƒé™
      console.log("AI ".concat(loginType, " \u767B\u5F55\u72B6\u6001\u5DF2\u66F4\u65B0\uFF0C\u4F46\u4FDD\u6301\u539F\u6709\u9009\u62E9"));
    },
    // æ ¹æ®å½“å‰AIç™»å½•çŠ¶æ€æ›´æ–°AIå¯ç”¨çŠ¶æ€ï¼ˆå·²åºŸå¼ƒï¼Œä¸å†ä¿®æ”¹enabledçŠ¶æ€ï¼‰
    updateAiEnabledStatus: function updateAiEnabledStatus() {
      // ä¸å†ä¿®æ”¹enabledçŠ¶æ€ï¼Œåªé€šè¿‡UIæ§åˆ¶æ“ä½œæƒé™
      console.log('AIç™»å½•çŠ¶æ€å·²æ›´æ–°ï¼Œä½†ä¿æŒåŸæœ‰é€‰æ‹©');
    },
    // å¾®å¤´æ¡ç›¸å…³æ–¹æ³•
    // å¾®å¤´æ¡æ–‡ç« ç¼–è¾‘ç›¸å…³æ–¹æ³•
    showTthArticleEditModal: function showTthArticleEditModal() {
      this.tthArticleEditVisible = true;
    },
    closeTthArticleEditModal: function closeTthArticleEditModal() {
      this.tthArticleEditVisible = false;
    },
    confirmTTHPublish: function confirmTTHPublish() {
      if (!this.tthArticleTitle || !this.tthArticleContent) {
        uni.showToast({
          title: 'è¯·å¡«å†™æ ‡é¢˜å’Œå†…å®¹',
          icon: 'none'
        });
        return;
      }
      var publishRequest = {
        jsonrpc: '2.0',
        id: this.generateUUID(),
        method: 'å¾®å¤´æ¡å‘å¸ƒ',
        params: {
          taskId: this.generateUUID(),
          userId: this.userId,
          corpId: this.corpId,
          roles: '',
          title: this.tthArticleTitle,
          content: this.tthArticleContent,
          type: 'å¾®å¤´æ¡å‘å¸ƒ'
        }
      };
      this.message(publishRequest);
      this.tthArticleEditVisible = false;
      this.tthFlowVisible = true;
      this.tthFlowLogs = [];
      this.tthFlowImages = [];
      uni.showToast({
        title: 'å¾®å¤´æ¡å‘å¸ƒè¯·æ±‚å·²å‘é€ï¼',
        icon: 'success'
      });
    },
    // å¾®å¤´æ¡å‘å¸ƒæµç¨‹ç›¸å…³æ–¹æ³•
    closeTthFlowDialog: function closeTthFlowDialog() {
      this.tthFlowVisible = false;
      this.tthFlowLogs = [];
      this.tthFlowImages = [];
    },
    // HTMLè½¬çº¯æ–‡æœ¬æ–¹æ³•
    htmlToText: function htmlToText(html) {
      if (!html) return '';
      return html.replace(/<[^>]*>/g, '');
    },
    // æ ¼å¼åŒ–æ—¶é—´
    formatTime: function formatTime(timestamp) {
      try {
        if (!timestamp) {
          return 'æ—¶é—´æœªçŸ¥';
        }
        var date;
        if (typeof timestamp === 'number') {
          date = new Date(timestamp);
        } else if (typeof timestamp === 'string') {
          // å¤„ç†ISO 8601æ ¼å¼ï¼š2025-06-25T07:18:54.110Z
          if (timestamp.includes('T') && (timestamp.includes('Z') || timestamp.includes('+'))) {
            date = new Date(timestamp);
          }
          // å¤„ç† "2025-6-23 14:53:12" è¿™ç§æ ¼å¼
          else {
            var match = timestamp.match(/(\d{4})-(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{1,2}):(\d{1,2})/);
            if (match) {
              var _match3 = (0, _slicedToArray2.default)(match, 7),
                year = _match3[1],
                month = _match3[2],
                day = _match3[3],
                _hour2 = _match3[4],
                _minute2 = _match3[5],
                _second = _match3[6];
              date = new Date(parseInt(year), parseInt(month) - 1, parseInt(day), parseInt(_hour2), parseInt(_minute2), parseInt(_second));
            } else {
              // å¦‚æœæ­£åˆ™ä¸åŒ¹é…ï¼Œå°è¯•å…¶ä»–æ–¹å¼
              var fixedTimestamp = timestamp.replace(/\s/g, 'T');
              date = new Date(fixedTimestamp);
              if (isNaN(date.getTime())) {
                date = new Date(timestamp);
              }
            }
          }
        } else if (timestamp instanceof Date) {
          date = timestamp;
        } else {
          date = new Date(timestamp);
        }
        if (isNaN(date.getTime())) {
          return 'æ—¶é—´æœªçŸ¥';
        }

        // ä½¿ç”¨æ›´ç®€æ´çš„æ—¶é—´æ ¼å¼ï¼Œé¿å…æ˜¾ç¤ºæ—¶åŒºä¿¡æ¯
        var hour = date.getHours().toString().padStart(2, '0');
        var minute = date.getMinutes().toString().padStart(2, '0');
        var second = date.getSeconds().toString().padStart(2, '0');
        var timeString = "".concat(hour, ":").concat(minute, ":").concat(second);
        return timeString;
      } catch (error) {
        console.error('æ ¼å¼åŒ–æ—¶é—´é”™è¯¯:', error, timestamp);
        return 'æ—¶é—´æœªçŸ¥';
      }
    }
  }
};
exports.default = _default;
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/wx.js */ 1)["default"], __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */ 2)["default"]))

/***/ }),

/***/ 84:
/*!*******************************************************************************************************************!*\
  !*** D:/AAAi/U3W-AI-main/cube-mini/pages/work/index.vue?vue&type=style&index=0&id=51b5538d&scoped=true&lang=css& ***!
  \*******************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_style_index_0_id_51b5538d_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-2!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src??ref--6-oneOf-1-3!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../å°çº¢å¸½/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=51b5538d&scoped=true&lang=css& */ 85);
/* harmony import */ var _HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_style_index_0_id_51b5538d_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_style_index_0_id_51b5538d_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_style_index_0_id_51b5538d_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__) if(["default"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_style_index_0_id_51b5538d_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_HBuilderX_4_76_2025082103_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_style_index_0_id_51b5538d_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ 85:
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-2!./node_modules/postcss-loader/src??ref--6-oneOf-1-3!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!D:/AAAi/U3W-AI-main/cube-mini/pages/work/index.vue?vue&type=style&index=0&id=51b5538d&scoped=true&lang=css& ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ })

},[[66,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/work/index.js.map